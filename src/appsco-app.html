<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">

<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">

<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-ajax/iron-request.html">
<link rel="import" href="../bower_components/iron-media-query/iron-media-query.html">

<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation-runner-behavior.html">

<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../bower_components/paper-progress/paper-progress.html">
<link rel="import" href="../bower_components/paper-styles/typography.html">
<link rel="import" href="../bower_components/paper-styles/color.html">

<link rel="import" href="components/header/appsco-header.html">
<link rel="import" href="components/header/appsco-account-chat.html">
<link rel="import" href="components/components/appsco-api.html">
<link rel="import" href="components/components/appsco-api-errors.html">

<link rel="import" href="components/application/appsco-application-add.html">
<link rel="import" href="components/application/appsco-application-share.html">
<link rel="import" href="components/application/appsco-application-remove.html">
<link rel="import" href="components/application/appsco-application-subscriber-revoke.html">
<link rel="import" href="components/application/appsco-application-revoke.html">
<link rel="import" href="components/application/company/appsco-company-application-add.html">
<link rel="import" href="components/application/company/appsco-company-sso-application-add.html">
<link rel="import" href="components/application/company/appsco-company-application-share.html">
<link rel="import" href="components/application/company/appsco-company-application-remove.html">
<link rel="import" href="components/application/company/appsco-application-orgunit.html">
<link rel="import" href="components/application/company/appsco-application-remove-orgunit.html">
<link rel="import" href="components/application/company/appsco-application-assignee-claims.html">
<link rel="import" href="components/application/company/appsco-application-assignee-revoke.html">
<link rel="import" href="components/application/appsco-import-resources.html">
<link rel="import" href="components/application/appsco-application-remove-group.html">

<link rel="import" href="components/group/appsco-company-remove-group.html">
<link rel="import" href="components/group/appsco-company-add-group.html">
<link rel="import" href="components/group/appsco-resource-add-groups.html">
<link rel="import" href="components/group/appsco-group-add-resource.html">
<link rel="import" href="components/group/appsco-resource-remove-from-group.html">
<link rel="import" href="components/group/appsco-manage-group-page-actions.html">

<link rel="import" href="components/account/appsco-account-authorized-app-revoke.html">

<link rel="import" href="application/appsco-application-settings-dialog.html">
<link rel="import" href="application/appsco-home-page-actions.html">
<link rel="import" href="application/appsco-resource-page-actions.html">
<link rel="import" href="account/appsco-account-page-actions.html">
<link rel="import" href="upgrade/appsco-upgrade-page-actions.html">
<link rel="import" href="company/appsco-company-home-page-actions.html">
<link rel="import" href="company/appsco-contact-home-page-actions.html">
<link rel="import" href="applications/appsco-resources-page-actions.html">
<link rel="import" href="applications/appsco-manage-resource-page-actions.html">
<link rel="import" href="billing/appsco-billing-page-actions.html">

<link rel="import" href="components/group/appsco-groups-page-actions.html">

<link rel="import" href="directory/appsco-directory-page-actions.html">
<link rel="import" href="directory/appsco-manage-account-page-actions.html">
<link rel="import" href="components/account/appsco-invitation-remove.html">
<link rel="import" href="directory/appsco-directory-add-account.html">
<link rel="import" href="directory/appsco-import-accounts.html">

<link rel="import" href="upgrade/appsco-upgrade-action.html">
<link rel="import" href="billing/appsco-subscription-cancel.html">
<link rel="import" href="billing/appsco-credit-card.html">
<link rel="import" href="billing/appsco-billing-send-invoice.html">

<link rel="import" href="vault/appsco-vault-page-actions.html">
<link rel="import" href="vault/appsco-vault-manage-item.html">
<link rel="import" href="components/vault/appsco-vault-remove.html">

<link rel="import" href="components/orgunit/appsco-orgunit-modify.html">
<link rel="import" href="components/orgunit/appsco-orgunit-remove.html">

<link rel="import" href="components/account/company/appsco-account-orgunit.html">
<link rel="import" href="components/account/company/appsco-account-remove-orgunit.html">
<link rel="import" href="components/account/company/appsco-account-remove-group.html">
<link rel="import" href="components/account/company/appsco-account-remove.html">
<link rel="import" href="account/appsco-account-disable-2fa.html">
<link rel="import" href="components/contact/appsco-contact-remove-group.html">

<link rel="import" href="auditlog/appsco-audit-log-page-actions.html">

<link rel="import" href="provisioning/appsco-provisioning-settings-page-actions.html">
<link rel="import" href="provisioning/appsco-start-integration.html">

<link rel="import" href="company/appsco-company-page-actions.html">
<link rel="import" href="company/appsco-company-add-domain.html">
<link rel="import" href="company/appsco-company-remove-domain.html">
<link rel="import" href="company/appsco-company-domain-token.html">
<link rel="import" href="company-account/appsco-company-account-page-actions.html">
<link rel="import" href="company/appsco-deactivate-idp-settings.html">

<link rel="import" href="application/appsco-dialog-application-add.html">
<link rel="import" href="applications/appsco-dialog-application-company-add.html">

<link rel="import" href="components/contact/appsco-contacts-page-actions.html">
<link rel="import" href="components/contact/appsco-manage-contact-page-actions.html">
<link rel="import" href="components/contact/appsco-import-contacts.html">
<link rel="import" href="components/contact/appsco-add-contact.html">
<link rel="import" href="components/contact/appsco-delete-contact.html">
<link rel="import" href="components/contact/appsco-convert-contact.html">
<link rel="import" href="components/contact/appsco-delete-contacts.html">

<link rel="import" href="components/customer/appsco-remove-customer.html">
<link rel="import" href="components/customer/appsco-customers-page-actions.html">
<link rel="import" href="components/customer/appsco-add-customer.html">
<link rel="import" href="components/customer/appsco-remove-customers.html">
<link rel="import" href="components/customer/appsco-add-partner-admin-to-customers.html">
<link rel="import" href="components/customer/appsco-manage-customer-page-actions.html">
<link rel="import" href="components/customer/appsco-customer-partner-admin-remove.html">

<link rel="import" href="components/customer/appsco-import-customers.html">
<link rel="import" href="components/customer/appsco-import-customer-resources.html">

<link rel="import" href="components/report/appsco-reports-page-actions.html">
<link rel="import" href="components/report/appsco-access-report-page-actions.html">

<link rel="import" href="shared-styles.html">
<link rel="import" href="webkit-scrollbar-style.html">

<dom-module id="appsco-app">
    <template>
        <style include="shared-styles">
            :host {
                display: block;

                --brand-color: var(--app-primary-color);
                --brand-text-color: #ffffff;
                --brand-default-text-color: #ffffff;

                --app-primary-color: #279FBC;
                --app-primary-color-1: #39C2D7;
                --app-secondary-color: #273441;
                --app-secondary-color-1: #1183A4;
                --app-danger-color: #db4437;
                --app-warning-color: var(--paper-orange-300);
                --body-background-color: #f5f8fa;
                --body-background-color-darker: #dbdbdb;
                --app-primary-color-dark: #414042;
                --success-color: #5AC099;

                --primary-text-color: #414042;
                --secondary-text-color: #969696;

                --header-background-color: var(--brand-color);
                --header-text-color: var(--brand-text-color);
                --header-icon-color: var(--header-text-color);
                --header-divider-color: var(--header-text-color);

                --appsco-product-text-color: var(--header-text-color);

                --primary-button-background-color: var(--brand-color);

                --border-radius-base: 3px;

                --paper-progress-active-color: var(--success-color);

                --border-color: var(--divider-color);

            }

            /* Top header style START */
            appsco-header {
                height: 64px;
                padding: 16px 10px;
                box-sizing: border-box;
                background-color: var(--header-background-color);

                --appsco-brand: {
                     display: block;
                 };
                --appsco-product: {
                     height: 32px;
                     line-height: 35px;
                 };

                --paper-listbox: {
                     color: var(--app-secondary-color);
                 };

                --notifications-paper-card-header-text: {
                     color: var(--primary-text-color);
                 };

                --appsco-brand-logo: {
                    width: auto;
                }
            }
            /* Top header style END */

            /* Bottom header style START */
            app-header {
                background-color: #ffffff;
                box-shadow: 0 3px 3px -2px rgba(0, 0, 0, 0.4);
            }
            app-header paper-icon-button {
                --paper-icon-button-ink-color: white;
            }
            app-header .actions {
                height: 100%;
            }
            .page-title {
                margin-right: 10px;
                font-size: 18px;
                color: var(--primary-text-color);
                text-transform: capitalize;
            }
            /* Bottom header style END */

            /* Menu list style START */
            .drawer-list {
            }
            .drawer-list > a,
            .drawer-list div[disabled],
            .drawer-list div[head]
            {
                display: block;
                padding: 0 16px;
                text-decoration: none;
                color: var(--app-secondary-color);
                line-height: 36px;
                border-bottom: 1px solid var(--divider-color);
                outline: none;
                font-size: 14px;
            }
            .drawer-list div[head] {
                background-color: #279FBC;
                color: #ffffff;
            }
            .drawer-list div[head].business {
                background-color: #5AC099;
            }
            .drawer-list div[disabled] {
                opacity: 0.4;
            }
            .drawer-list a.iron-selected {
                background-color: var(--google-grey-300);
            }
            /* Menu list style END */

            :host app-drawer-layout[fullbleed] {
                top: 64px;
                overflow: hidden;
            }
            app-drawer {
                top: 64px;
                border-top: 1px solid #ffffff;
                height: calc(100vh - 64px);
                --app-drawer-content-container: {
                     padding-top: 0;
                     background: var(--body-background-color);
                     overflow: auto;
                 };
            }
            app-drawer iron-icon {
                --iron-icon-fill-color: var(--app-primary-color-dark);
            }
            app-toolbar {
                padding: 0 10px;
            }
            :host .flex-horizontal {
                @apply(--layout-horizontal);
                @apply(--layout-center);
            }
            :host .flex {
                @apply(--layout-flex);
            }
            .pages {
                height: 100%;
            }
            .menu-text {
                display: inline-block;
                vertical-align: middle;
                padding-left: 8px;
            }
            paper-progress {
                width: 100%;
                position: absolute;
                top: 64px;
                left: 0;
                z-index: 10;
            }
            paper-progress::shadow #primaryProgress {
                background-color: var(--paper-progress-active-color);
            }
            :host([tablet-screen]) {
                --appsco-paper-dialog: {
                     width: 90%;
                     top: 20vh;
                 };
            }
            :host([mobile-screen]) {
                --appsco-account-notifications-dropdown: {
                     width: 300px;
                 };

                --appsco-account-info-dropdown: {
                     width: 300px;
                 };
            }
            :host div[purchase] {
                margin-top: 20px;
                padding: 0 18px;
                @apply(--layout-vertical);
                @apply(--layout-center);
                @apply(--paper-font-body1);
                color: var(--primary-text-color);
            }
            :host div[purchase] a {
                width: 100%;
            }
            :host div[purchase] paper-button {
                @apply(--primary-button);
                background-color: var(--brand-color);
                border-color: var(--brand-color);
                width: 100%;
                margin-top: 10px;
            }
            :host div[purchase] a {
                display: block;
                text-decoration: none;
                outline: none;
            }
            .toast-close-action {
                position: absolute;
                top: 0;
                right: 2px;
                width: 18px;
                height: 18px;
                margin: 0;
                color: #ffffff;
            }
        </style>

        <iron-media-query query="(max-width: 600px)" query-matches="{{ mobileScreen }}"></iron-media-query>
        <iron-media-query query="(max-width: 800px)" query-matches="{{ tabletScreen }}"></iron-media-query>

        <appsco-api id="api" domain="[[ domain ]]" index="" name="{{ api }}"></appsco-api>
        <appsco-api-errors language="[[ language ]]" name="{{ _apiErrors }}"></appsco-api-errors>

        <app-location route="{{route}}"></app-location>
        <app-route
                route="{{route}}"
                pattern="[[_prefixPath]]/:page"
                data="{{routeData}}"
                tail="{{subroute}}"></app-route>

        <paper-toast id="toast"
                     text="[[ _toastMessage ]]"
                     on-iron-overlay-closed="_onToastMessageClosed">

            <template is="dom-if" if="[[ _toastPersistence ]]">
                <paper-icon-button icon="icons:close"
                                   class="toast-close-action"
                                   on-tap="_onCloseToastAction"></paper-icon-button>
            </template>
        </paper-toast>

        <appsco-header id="appscoHeader"
                account="[[ account ]]"
                brand-logo="[[ _brandLogo ]]"
                brand-logo-clickable="[[ _brandLogoClickable ]]"
                brand-logo-width="38"
                brand-logo-height="32"
                brand-title="[[ _brandTitle ]]"
                authorization-token="[[ authorizationToken ]]"
                notifications-api="[[ api.notifications ]]"
                logout-api="[[ api.logout ]]"
                notifications-size="5"
                product-business="[[ _companiesAccountHasPermissionTo ]]"
                product-partner="[[ account.partner ]]"
                domain="{{ domain }}"
                on-brand-action="_onBrandAction"
                on-vault-action="_onVaultAction"
                on-appsco-product-changed="_onAppscoProductChangeAction"
                on-account-chat="_onAccountChat"
                on-account-settings="_onAccountSettingsAction"
                on-all-notifications="_onAllNotifications"
                on-account-logout="_onAccountLogout"></appsco-header>

        <app-drawer-layout fullbleed force-narrow>

             <!--Drawer content -->
            <app-drawer id="appDrawer">
                <iron-selector selected="[[ page ]]"
                               attr-for-selected="name"
                               class="drawer-list"
                               role="navigation"
                               on-iron-select="_onMenuItemSelected">
                    <template is="dom-if" if="[[ !_companyPage ]]">
                        <a name="home" href="#">
                            <iron-icon icon="icons:home"></iron-icon> <span class="menu-text">Home</span>
                        </a>
                        <a name="vault" href="#">
                            <iron-icon icon="icons:work"></iron-icon> <span class="menu-text">Vault</span>
                        </a>

                        <template is="dom-if" if="[[ account.user_allowed_to_create_company ]]">
                            <div purchase>
                                <div>Manage your business applications, employees and get meaningful insights.</div>
                                <paper-button on-tap="_showTryBusinessPage">
                                    Try Appsco Business
                                </paper-button>
                            </div>
                        </template>
                    </template>

                    <template is="dom-if" if="[[ _companyPage ]]">
                        <template is="dom-if" if="[[ _companyUser ]]">
                            <a name="company-home" href="#">
                                <iron-icon icon="icons:apps"></iron-icon> <span class="menu-text">Dashboard</span>
                            </a>
                            <template is="dom-if" if="[[ _companyAdmin ]]">
                                <a name="resources" href="#">
                                    <iron-icon icon="icons:list"></iron-icon> <span class="menu-text">Resources</span>
                                </a>
                                <a name="directory" href="#">
                                    <iron-icon icon="icons:social:person"></iron-icon> <span class="menu-text">Directory</span>
                                </a>
                                <a name="contacts" href="#">
                                    <iron-icon icon="icons:perm-contact-calendar"></iron-icon> <span class="menu-text">Contacts</span>
                                </a>

                                <template is="dom-if" if="[[ currentCompany.company.is_partner ]]">
                                    <a name="customers" href="#">
                                        <iron-icon icon="icons:social:domain"></iron-icon> <span class="menu-text">Customers</span>
                                    </a>
                                </template>

                                <a name="groups" href="#">
                                    <iron-icon icon="icons:supervisor-account"></iron-icon> <span class="menu-text">Groups</span>
                                </a>
                                <a name="provisioning" href="#">
                                    <iron-icon icon="icons:compare-arrows"></iron-icon> <span class="menu-text">Provisioning</span>
                                </a>
                                <a name="audit-log" href="#">
                                    <iron-icon icon="icons:reorder"></iron-icon> <span class="menu-text">Audit</span>
                                </a>
                                <a name="statistics" href="#">
                                    <iron-icon icon="icons:donut-large"></iron-icon> <span class="menu-text">Statistics</span>
                                </a>
                                <a name="reports" href="#">
                                    <iron-icon icon="icons:description"></iron-icon>
                                    <span class="menu-text">Reports</span>
                                </a>
                                <a name="billing" href="#">
                                    <iron-icon icon="icons:payment"></iron-icon> <span class="menu-text">Billing</span>
                                </a>
                                <a name="company" href="#">
                                    <iron-icon icon="icons:settings"></iron-icon> <span class="menu-text">Settings</span>
                                </a>
                            </template>
                        </template>
                        <template is="dom-if" if="[[ _companyContact ]]">
                            <a name="contact-home" href="#">
                                <iron-icon icon="icons:apps"></iron-icon> <span class="menu-text">Dashboard</span>
                            </a>
                        </template>
                    </template>

                </iron-selector>
            </app-drawer>

            <!-- Main content -->
            <app-header-layout has-scrolling-region>

                <app-header>
                    <app-toolbar class="flex-horizontal">
                        <paper-icon-button icon="menu" drawer-toggle></paper-icon-button>
                        <div class="page-title" condense-title>[[ _pageName ]]</div>

                        <neon-animated-pages
                                id="animatedActions"
                                class="actions flex flex-end"
                                selected="[[page]]"
                                attr-for-selected="name"
                                on-neon-animation-finish="_onPageActionsAnimationFinish">

                            <appsco-home-page-actions id="appscoHomePageActions"
                                    name="home"
                                    on-add-item-action="_onAddItemAction"
                                    on-search="_onSearchApplications"
                                    on-search-clear="_onSearchApplicationsClear"
                                    on-filter-items="_onFilterItems"></appsco-home-page-actions>

                            <appsco-resource-page-actions
                                    id="appscoApplicationPageActions"
                                    name="resource"
                                    on-back="_showHomePage"
                                    on-resource-section="_onResourceActionApplicationPage"
                                    on-search-subscribers="_onSearchSubscribers"
                                    on-search-subscribers-clear="_onSearchSubscribersClear"></appsco-resource-page-actions>

                            <appsco-account-page-actions
                                    id="appscoAccountPageActions"
                                    name="account"
                                    on-back="_onBackFromAccountAction"
                                    on-resource-section="_onResourceActionPage"
                                    on-advanced-settings="_onAccountAdvancedSettings"></appsco-account-page-actions>

                            <appsco-company-account-page-actions
                                    id="appscoCompanyAccountPageActions"
                                    name="company-account"
                                    on-back="_onBackFromAccountAction"
                                    on-resource-section="_onResourceActionPage"
                                    on-advanced-settings="_onAccountAdvancedSettings"></appsco-company-account-page-actions>

                            <appsco-vault-page-actions
                                    name="vault"
                                    authorization-token="[[ authorizationToken ]]"
                                    on-add-vault-action="_onAddVaultAction"></appsco-vault-page-actions>

                            <appsco-upgrade-page-actions
                                    name="upgrade"
                                    authorization-token="[[ authorizationToken ]]"
                                    on-toggle-pricing="_onUpgradeTogglePricing"></appsco-upgrade-page-actions>

                            <appsco-company-home-page-actions id="appscoCompanyHomePageActions"
                                                      name="company-home"
                                                      on-search="_onSearchApplications"
                                                      on-search-clear="_onSearchApplicationsClear"></appsco-company-home-page-actions>

                            <appsco-contact-home-page-actions id="appscoContactHomePageActions"
                                                              name="contact-home"
                                                              on-search="_onSearchApplications"
                                                              on-search-clear="_onSearchApplicationsClear"></appsco-contact-home-page-actions>

                            <appsco-resources-page-actions id="appscoResourcesPageActions"
                                    name="resources"
                                    authorization-token="[[ authorizationToken ]]"
                                    filter-api="[[ api.dashboards ]]?extended=1"
                                    on-add-item-action="_onAddCompanyItemAction"
                                    on-import-resources="_onImportResourcesAction"
                                    on-search="_onSearchCompanyApplications"
                                    on-search-clear="_onSearchCompanyApplicationsClear"
                                    on-share="_onShareApplications"
                                    on-remove="_onRemoveApplications"
                                    on-share-to-group="_onShareResourcesToGroup"
                                    on-orgunits="_onAddApplicationsToOrgunit"></appsco-resources-page-actions>

                            <appsco-manage-resource-page-actions
                                    id="appscoManageApplicationPageActions"
                                    name="manage-resource"
                                    on-back="_showCompanyResourcesPage"
                                    on-resource-section="_onResourceActionManageApplicationPage"
                                    on-search-assignees="_onSearchAssignees"
                                    on-search-assignees-clear="_onSearchAssigneesClear"></appsco-manage-resource-page-actions>

                            <appsco-directory-page-actions
                                    id="appscoDirectoryPageActions"
                                    name="directory"
                                    authorization-token="[[ authorizationToken ]]"
                                    on-add-account="_onCompanyAddAccount"
                                    on-import-accounts="_onCompanyImportAccounts"
                                    on-search="_onSearchAccounts"
                                    on-search-clear="_onSearchAccountsClear"
                                    on-upgrade="_fireUpgrade"
                                    on-remove="_onRemoveAccounts"
                                    on-add-groups-to-company-roles="_onAddGroupsToCompanyRoles"
                                    on-orgunits="_onAddAccountsToOrgunit"
                                    on-manage-domains="_onManageDomains"
                                    on-filter-roles="_onFilterRoles"
                            ></appsco-directory-page-actions>

                            <appsco-manage-account-page-actions
                                    name="manage-account"
                                    on-back="_showCompanyDirectoryPage"
                                    on-resource-section="_onResourceActionManageAccountPage"></appsco-manage-account-page-actions>

                            <appsco-contacts-page-actions
                                    id="appscoContactsPageActions"
                                    name="contacts"
                                    on-add-contact="_onAddContactAction"
                                    on-import-contacts="_onImportContactsAction"
                                    on-delete-contacts="_onDeleteContactsAction"
                                    on-add-groups-to-contacts="_onAddGroupsToContactsAction"
                                    on-select-all-contacts="_onSelectAllContactsAction"
                                    on-page-selected="_onContactsPageSelected"
                                    on-search="_onSearchContacts"
                                    on-search-clear="_onSearchContactsClear"
                            ></appsco-contacts-page-actions>

                            <appsco-groups-page-actions id="appscoGroupsPageActions"
                                                           name="groups"
                                                           authorization-token="[[ authorizationToken ]]"
                                                           on-add-company-group="_onAddCompanyGroupAction"
                                                           on-search="_onSearchCompanyGroupAction"
                                                           on-search-clear="_onSearchCompanyGroupClear"
                            ></appsco-groups-page-actions>

                            <appsco-manage-contact-page-actions
                                    name="manage-contact"
                                    on-back="_showContactsPage"
                                    on-resource-section="_onResourceActionPage"></appsco-manage-contact-page-actions>

                            <appsco-manage-customer-page-actions
                                    name="manage-customer"
                                    on-back="_showCustomersPage"
                                    on-resource-section="_onResourceActionPage"></appsco-manage-customer-page-actions>

                            <appsco-manage-group-page-actions
                                    name="manage-group"
                                    on-back="_showGroupsPage"
                                    on-add-item-to-group-action="_onAddItemToGroupAction"
                                    on-resource-section="_onResourceActionPage"></appsco-manage-group-page-actions>

                            <appsco-customers-page-actions
                                    id="appscoCustomersPageActions"
                                    name="customers"
                                    on-search="_onSearchCustomersAction"
                                    on-search-clear="_onSearchCustomersClearAction"
                                    on-add-customer="_onAddCustomerAction"
                                    on-remove-customers="_onRemoveCustomersAction"
                                    on-add-partner-admin="_onAddPartnerAdminToCustomersAction"
                                    on-import-customers="_onImportCustomersAction"
                                    on-import-customer-resources="_onImportCustomerResources"
                                    on-export-customers="F"
                            ></appsco-customers-page-actions>

                            <appsco-audit-log-page-actions
                                    name="audit-log"
                                    on-resource-section="_onResourceActionAuditLogPage"></appsco-audit-log-page-actions>

                            <appsco-billing-page-actions
                                    name="billing"
                                    on-resource-section="_onResourceActionBillingPage"></appsco-billing-page-actions>

                            <appsco-provisioning-settings-page-actions
                                    id="appscoProvisioningSettingsPageActions"
                                    name="provisioning-settings"
                                    on-back="_showCompanyProvisioningPage"
                                    on-resource-section="_onResourceActionProvisioningSettingsPage"
                                    on-sync-accounts="_onSyncAccounts"
                                    on-refresh-accounts="_onRefreshAccounts"></appsco-provisioning-settings-page-actions>

                            <appsco-company-page-actions
                                    id="appscoCompanyPageActions"
                                    name="company"
                                    on-resource-section="_onResourceActionCompanyPage"
                                    on-add-domain="_onAddDomain"
                                    on-search-groups="_onSearchGroups"
                                    on-search-groups-clear="_onSearchGroupsClear"></appsco-company-page-actions>

                            <appsco-reports-page-actions id="appscoReportsPageActions"
                                                        name="reports"></appsco-reports-page-actions>

                            <appsco-access-report-page-actions
                                    id="appscoAccessReportPageActions"
                                    name="access-report"
                                    on-back="_showReportsPage"
                                    on-resource-section="_onResourceActionPage"></appsco-access-report-page-actions>
                        </neon-animated-pages>

                    </app-toolbar>
                </app-header>

                <paper-progress id="pageProgress" indeterminate></paper-progress>

                <neon-animated-pages
                        class="pages"
                        selected="[[page]]"
                        attr-for-selected="name"
                        fallback-selection="404"
                        role="main"
                        on-neon-animation-finish="_onPageAnimationFinish">

                    <appsco-home-page
                            id="appscoHomePage"
                            name="home"
                            application="{{ application }}"
                            account="[[ account ]]"
                            application-log="[[ application.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            applications-api="[[ _applicationsApi ]]"
                            on-loaded="_onLoadedPage"
                            on-edit-application="_onEditApplication"
                            on-info-edit-application="_onInfoEditApplication"
                            on-share-application="_onShareApplication"
                            on-revoke-application="_onRevokeApplication"
                            on-applications-removed="_onApplicationsRemovedFromHomePage"></appsco-home-page>

                    <appsco-resource-page
                            id="appscoApplicationPage"
                            name="resource"
                            route="[[ subroute ]]"
                            company="[[ _companyPage ]]"
                            application="{{ application }}"
                            applications-api="[[ _applicationsApi ]]"
                            application-log="[[ application.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            accounts-api="[[ api.accounts ]]"
                            account="{{ account }}"
                            on-share-application="_onShareApplication"
                            on-remove-application="_onRemoveApplication"
                            on-subscription-revoke="_onSubscriptionRevoke"
                            on-application-settings-saved="_onApplicationSettingsSaved"
                            on-application-settings-no-changes="_onApplicationSettingsNoChanges"
                            on-autologin-changed="_onAutologinChanged"
                            on-enable-subscribers-search-action="_onEnableSubscribersSearchAction"
                            on-disable-subscribers-search-action="_onDisableSubscribersSearchAction"
                            on-page-error="_onError"></appsco-resource-page>

                    <appsco-account-page
                            id="appscoAccountPage"
                            name="account"
                            account="{{ account }}"
                            authorization-token="[[ authorizationToken ]]"
                            notifications-api="[[ api.notifications ]]"
                            authorized-apps-api="[[ api.authorizedApps ]]"
                            log-api="[[ api.accountLog ]]"
                            two-fa-api="[[ api.twoFA ]]"
                            two-fa-qr-api="[[ api.twoFAQr ]]"
                            two-fa-codes-api="[[ api.twoFACodes ]]"
                            settings-api="[[ api.me ]]"
                            image-settings-api="[[ api.profileImage ]]"
                            transfer-token-api="[[ api.transferToken ]]"
                            change-password-api="[[ api.changePassword ]]"
                            partner-api="[[ api.partner ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-settings-saved="_onAccountSettingsSaved"
                            on-password-changed="_onAccountPasswordChanged"></appsco-account-page>

                    <appsco-company-account-page
                            id="appscoCompanyAccountPage"
                            name="company-account"
                            account="{{ account }}"
                            authorization-token="[[ authorizationToken ]]"
                            notifications-api="[[ api.notifications ]]"
                            authorized-apps-api="[[ api.authorizedApps ]]"
                            log-api="[[ api.accountLog ]]"
                            two-fa-api="[[ api.twoFA ]]"
                            two-fa-qr-api="[[ api.twoFAQr ]]"
                            two-fa-codes-api="[[ api.twoFACodes ]]"
                            settings-api="[[ api.me ]]"
                            image-settings-api="[[ api.profileImage ]]"
                            transfer-token-api="[[ api.transferToken ]]"
                            change-password-api="[[ api.changePassword ]]"
                            partner-api="[[ api.partner ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-settings-saved="_onAccountSettingsSaved"
                            on-password-changed="_onAccountPasswordChanged"></appsco-company-account-page>

                    <appsco-vault-page
                            id="appscoVaultPage"
                            name="vault"
                            authorization-token="[[ authorizationToken ]]"
                            api="[[ api ]]"
                            on-loaded="_onLoadedVaultItems"
                            on-edit="_onEditVaultAction"
                            on-remove-vault-item="_onRemoveVaultAction">
                    </appsco-vault-page>

                    <appsco-trybusiness-page
                            id="appscoUpgradePage"
                            name="trybusiness"
                            authorization-token="[[ authorizationToken ]]"
                            company-upgrade-api="[[ api.upgradeToBusiness ]]"
                            on-upgraded="_upgradedToBusiness"
                            on-upgrade-failed="_onUpgradeToCompanyFailed"
                    ></appsco-trybusiness-page>

                    <appsco-company-home-page
                            id="appscoCompanyHomePage"
                            name="company-home"
                            authorization-token="[[ authorizationToken ]]"
                            applications-api="[[ _companyIconsApi ]]"
                            account="[[ account ]]"
                            on-loaded="_onLoadedPage"
                    ></appsco-company-home-page>

                    <appsco-contact-home-page
                            id="appscoContactHomePage"
                            name="contact-home"
                            authorization-token="[[ authorizationToken ]]"
                            applications-api="[[ _contactIconsApi ]]"
                            on-loaded="_onLoadedPage"
                    ></appsco-contact-home-page>

                    <appsco-resources-page
                            id="appscoResourcesPage"
                            name="resources"
                            resource="{{ _companyApplication }}"
                            account="[[ account ]]"
                            application-log="[[ _companyApplication.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            computed-headers="[[ _computedHeaders ]]"
                            company-resources-api="[[ _companyApplicationsApi ]]"
                            company-orgunits-api="[[ _companyOrgunitsApi ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-list-loaded="_onLoadedPage"
                            on-edit-resource="_onEditCompanyResource"
                            on-info-edit-resource="_onInfoEditCompanyResource"
                            on-share-company-resource="_onShareCompanyResource"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideResourcesBulkActions"
                            on-add-orgunit="_onAddOrgunit"
                            on-modify-orgunit="_onModifyOrgunit"
                            on-remove-orgunit="_onRemoveOrgunit"></appsco-resources-page>

                    <appsco-manage-resource-page
                            id="appscoManageApplicationPage"
                            name="manage-resource"
                            route="[[ subroute ]]"
                            application="{{ _companyApplication }}"
                            company-api="[[ _companyApi ]]"
                            company-idp-saml-metadata-api="[[ _companySamlMetadataApi ]]"
                            domain="[[ domain ]]"
                            application-log="[[ _companyApplication.meta.log ]]"
                            authorization-token="[[ authorizationToken ]]"
                            accounts-api="[[ api.accounts ]]"
                            account="{{ account }}"
                            api-errors="[[ _apiErrors ]]"
                            on-share-company-resource="_onShareCompanyResource"
                            on-remove-application="_onRemoveCompanyApplication"
                            on-revoke-assignee="_onRevokeAssigneeAccess"
                            on-application-settings-saved="_onApplicationSettingsSaved"
                            on-application-settings-no-changes="_onApplicationSettingsNoChanges"
                            on-add-to-orgunit="_onAddApplicationToOrgunit"
                            on-remove-from-orgunit="_onRemoveApplicationFromOrgunit"
                            on-enable-assignees-search-action="_onEnableAssigneesSearchAction"
                            on-disable-assignees-search-action="_onDisableAssigneesSearchAction"
                            on-page-error="_onError"
                            on-remove-from-group="_onRemoveApplicationFromGroup"></appsco-manage-resource-page>

                    <appsco-directory-page
                            id="appscoDirectoryPage"
                            name="directory"
                            role="{{ _role }}"
                            selected-accounts="{{ _selectedAccounts }}"
                            authorization-token="[[ authorizationToken ]]"
                            computed-headers="[[ _computedHeaders ]]"
                            company-invitations-api="[[ _companyInvitationsApi ]]"
                            company-directory-roles-api="[[ _companyRolesApi ]]"
                            company-orgunits-api="[[ _companyOrgunitsApi ]]"
                            domains-api="[[ _companyDomainsApi ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            on-invitation-resent="_onInvitationResent"
                            on-hide-subscription-limit-reached-info="_onHideSubscriptionLimitReachedInfo"
                            on-show-domain-not-verified-info="_onShowDomainNotVerifiedInfo"
                            on-hide-domain-not-verified-info="_onHideDomainNotVerifiedInfo"
                            on-edit-account="_onEditAccount"
                            on-info-edit-account="_onEditAccount"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideDirectoryBulkActions"
                            on-add-orgunit="_onAddOrgunit"
                            on-modify-orgunit="_onModifyOrgunit"
                            on-remove-orgunit="_onRemoveOrgunit"
                            on-reset-type-filter="_onResetDirectoryTypeFilter"></appsco-directory-page>

                    <appsco-contacts-page
                            id="appscoContactsPage"
                            name="contacts"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            company-invitations-api="[[ _companyInvitationsApi ]]"
                            company-contacts-api="[[ _companyContactsApi ]]"
                            on-edit-contact="_onEditContactAction"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideContactsBulkActions"
                            on-invitation-resent="_onContactInvitationResent"

                    ></appsco-contacts-page>

                    <appsco-customers-page
                            id="appscoCustomersPage"
                            name="customers"
                            customers-api="[[ _companyCustomersApi ]]"
                            customers-export-api="[[ _companyCustomersExportApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-edit-customer="_onEditCustomerAction"
                            on-show-bulk-actions="_onShowBulkActions"
                            on-hide-bulk-actions="_onHideCustomersBulkActions"
                    ></appsco-customers-page>

                    <appsco-groups-page
                            id="appscoGroupsPage"
                            name="groups"
                            group="{{ _group }}"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            on-edit-item="_onEditCompanyGroupAction"
                            on-info-edit-group="_onEditCompanyGroupAction"
                    ></appsco-groups-page>


                    <appsco-manage-account-page
                            id="appscoManageAccountPage"
                            name="manage-account"
                            route="[[ subroute ]]"
                            role="{{ _role }}"
                            administrator="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            company-api="[[ _companyApi ]]"
                            notifications-api="[[ api.notifications ]]"
                            log-api="[[ api.accountLog ]]"
                            two-fa-api="[[ api.twoFA ]]"
                            settings-api="[[ api.me ]]"
                            image-settings-api="[[ api.profileImage ]]"
                            change-password-api="[[ api.changePassword ]]"
                            on-settings-saved="_onAccountSettingsSaved"
                            on-password-changed="_onCompanyAccountPasswordChanged"
                            on-add-to-orgunit="_onAddAccountToOrgunit"
                            on-remove-from-orgunit="_onRemoveAccountFromOrgunit"
                            on-remove-from-group="_onRemoveAccountFromGroup"
                            on-account-role-changed="_onAccountRoleChanged"
                            on-page-error="_onError"
                            on-revoke-assignee="_onRevokeAssigneeAccess"
                    ></appsco-manage-account-page>

                    <appsco-manage-contact-page
                            id="appscoManageContactPage"
                            name="manage-contact"
                            route="[[ subroute ]]"
                            authorization-token="[[ authorizationToken ]]"
                            contacts-api="[[ _companyContactsApi ]]"
                            on-convert-contact-to-user="_onConvertContactToUserAction"
                            on-remove-from-group="_onRemoveContactFromGroup"
                            on-delete-contact="_onDeleteContactAction"
                            on-page-error="_onError"
                            on-revoke-assignee="_onRevokeAssigneeAccess"
                    ></appsco-manage-contact-page>

                    <appsco-manage-customer-page
                            id="appscoManageCustomerPage"
                            name="manage-customer"
                            route="[[ subroute ]]"
                            authorization-token="[[ authorizationToken ]]"
                            customers-api="[[ _companyCustomersApi ]]"
                            on-delete-customer="_onDeleteCustomerAction"
                            on-page-error="_onError",
                            on-remove-partner-admin-from-customer="_onRemovePartnerAdminFromCustomer"
                            on-add-partner-admin="_onAddPartnerAdminAction"
                    ></appsco-manage-customer-page>

                    <appsco-manage-group-page
                            id="appscoManageGroupPage"
                            name="manage-group"
                            route="[[ subroute ]]"
                            group="{{ _group }}"
                            authorization-token="[[ authorizationToken ]]"
                            group-api="[[ _companyGroupApi ]]"
                            on-remove-group="_onRemoveGroupAction"
                            on-page-error="_onError"
                            on-remove-company-role-from-group="_onRemoveCompanyRoleFromGroup"
                            on-remove-company-contact-from-group="_onRemoveCompanyContactFromGroup"
                            on-remove-company-resource-from-group="_onRemoveCompanyResourceFromGroup"
                    ></appsco-manage-group-page>

                    <appsco-provisioning-page
                            id="appscoProvisioningPage"
                            name="provisioning"
                            company-api="[[ _companyApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            on-available-integration="_onStartAuthorization"
                            on-active-integration="_onIntegrationSetup"
                    ></appsco-provisioning-page>

                    <appsco-provisioning-settings-page
                            id="appscoProvisioningSettingsPage"
                            name="provisioning-settings"
                            authorization-token="[[ authorizationToken ]]"
                            integration="[[ _selectedIntegration ]]"
                            company-roles-api="[[ _companyRolesApi ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-back="_showCompanyProvisioningPage"
                            on-local-account-synced="_onLocalAccountSynced"
                            on-new-account-synced="_onNewAccountSynced"
                            on-accounts-sync-new-account-synced="_onNewAccountSynced"
                            on-accounts-sync-finished="_onAccountsSyncFinished"
                            on-synced-account-removed="_onSyncedAccountRemoved"
                            on-initialize-page="_onInitializeProvisioningPage"
                            on-reset-page="_onResetProvisioningPage"
                            on-show-bulk-actions="_onShowBulkActionsProvisioningPage"
                            on-hide-bulk-actions="_onHideBulkActionsProvisioningPage"
                    ></appsco-provisioning-settings-page>

                    <appsco-provisioning-integration-authorization-success-page
                            id="appscoProvisioningIntegrationSuccessPage"
                            name="provisioning-integration-authorization-success"
                            on-provisioning="_showCompanyProvisioningPage"
                    ></appsco-provisioning-integration-authorization-success-page>

                    <appsco-provisioning-integration-authorization-failed-page
                            id="appscoProvisioningIntegrationFailedPage"
                            name="provisioning-integration-authorization-failed"
                            on-provisioning="_showCompanyProvisioningPage"
                    ></appsco-provisioning-integration-authorization-failed-page>

                    <appsco-audit-log-page
                            id="appscoAuditLogPage"
                            name="audit-log"
                            authorization-token="[[ authorizationToken ]]"
                            audit-log-api="[[ _companyAuditLogApi ]]"
                            company-api="[[ _companyApi ]]"></appsco-audit-log-page>

                    <appsco-statistics-page
                            id="appscoStatisticsPage"
                            name="statistics"
                            company-api="[[ _companyApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                    ></appsco-statistics-page>

                    <appsco-reports-page
                            id="appscoReportsPage"
                            name="reports"
                            get-access-report-api="[[ _getAccessReportApi ]]"
                            authorization-token="[[ authorizationToken ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-open-access-report="_showAccessReportPage"></appsco-reports-page>

                    <appsco-access-report-page
                            id="appscoAccessReportPage"
                            name="access-report"
                            authorization-token="[[ authorizationToken ]]"
                            groups-api="[[ _companyGroupsApi ]]"
                            roles-api="[[ _companyRolesApi ]]"
                            contacts-api="[[ _companyContactsApi ]]"
                            export-access-report-api="[[ _exportAccessReportApi ]]"
                            api-errors="[[ _apiErrors ]]"></appsco-access-report-page>

                    <appsco-billing-page
                            id="appscoBillingPage"
                            name="billing"
                            company-api="[[ _companyApi ]]"
                            account="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            on-manage-credit-card="_onManageCreditCard"
                            on-send-invoice="_onSendInvoice"></appsco-billing-page>

                    <appsco-company-page
                            id="appscoCompanyPage"
                            name="company"
                            company="{{ currentCompany.company }}"
                            account="[[ account ]]"
                            authorization-token="[[ authorizationToken ]]"
                            computed-headers="[[ _computedHeaders ]]"
                            brand-logo="[[ _brandLogo ]]"
                            api-errors="[[ _apiErrors ]]"
                            on-company-settings-changed="_onCompanySettingsChanged"
                            on-company-brand-settings-changed="_onCompanyBrandSettingsChanged"
                            on-company-logo-changed="_onCompanyLogoChanged"
                            on-show-domains-page-actions="_onShowDomainsPageActions"
                            on-hide-domains-page-actions="_onHideDomainsPageActions"
                            on-show-groups-page-actions="_onShowGroupsPageActions"
                            on-hide-groups-page-actions="_onHideGroupsPageActions"
                            on-remove-domain="_onRemoveDomain"
                            on-get-token="_onDomainGetToken"
                            on-domain-verified="_onDomainVerified"
                            on-domain-not-verified="_onDomainNotVerified"
                            on-remove-group-from-company-role="_onRemoveGroupFromCompanyRole"
                            on-idp-settings-saved="_onIdPSettingsSaved"
                            on-deactivate-domain-idp-settings="_onDeactivateDomainIdPSettings"
                    ></appsco-company-page>

                    <appsco-logout-page name="logout"
                                        logout-api="[[ api.logout ]]"></appsco-logout-page>

                    <appsco-not-found-page name="404"
                                           on-back-to-home-page="_onBackToHomePageAction"></appsco-not-found-page>
                </neon-animated-pages>
            </app-header-layout>
        </app-drawer-layout>

        <appsco-account-chat
                id="appscoAccountChat"
                account="{{ account }}"
                chat="{{ chat }}"
                dont-close-outside>
        </appsco-account-chat>

        <appsco-application-add
                id="appscoApplicationAdd"
                authorization-token="[[ authorizationToken ]]"
                applications-template-api="[[ api.applicationTemplates ]]"
                dashboard-api="[[ _addAppApi ]]"
                link-api="[[ api.link ]]"
                item-api="[[ api.item ]]"
                on-application-added="_onApplicationAdded"
                on-link-added="_onApplicationAdded">
        </appsco-application-add>

        <appsco-application-share
                id="appscoApplicationShare"
                application="[[ application ]]"
                authorization-token="[[ authorizationToken ]]"
                accounts-api="[[ api.accounts ]]"
                on-application-shared="_onApplicationShared"
                ></appsco-application-share>

        <appsco-application-settings-dialog
                id="appscoApplicationSettingsDialog"
                account="[[ account ]]"
                authorization-token="[[ authorizationToken ]]"
                application="[[ application ]]"
                on-application-settings-saved="_onApplicationCredentialsChanged"
        ></appsco-application-settings-dialog>

        <appsco-application-remove
                id="appscoApplicationRemove"
                application="[[ application ]]"
                authorization-token="[[ authorizationToken ]]"
                on-application-removed="_onApplicationRemoved"></appsco-application-remove>

        <appsco-account-authorized-app-revoke
                id="appscoAccountAuthorizedAppRevoke"
                application="[[ _authorizedApplication ]]"
                authorization-token="[[ authorizationToken ]]"
                on-application-revoked="_onAuthorizedApplicationRevoked"></appsco-account-authorized-app-revoke>

        <appsco-application-subscriber-revoke
                id="appscoApplicationSubscriberRevoke"
                authorization-token="[[ authorizationToken ]]"
                on-subscription-revoked="_onSubscriptionRevoked"
        ></appsco-application-subscriber-revoke>

        <appsco-application-revoke
                id="appscoApplicationRevoke"
                authorization-token="[[ authorizationToken ]]"
                on-application-instance-removed="_onApplicationInstanceRevoked"
        ></appsco-application-revoke>

        <appsco-vault-remove
                id="appscoVaultItemRemove"
                authorization-token="[[ authorizationToken ]]"
                on-vault-item-removed="_onVaultItemRemoved"
        ></appsco-vault-remove>

        <appsco-vault-manage-item
                id="appscoVaultItemManage"
                authorization-token="[[ authorizationToken ]]"
                api="[[ api ]]"
                on-item-saved="_onItemSaved"
        ></appsco-vault-manage-item>

        <appsco-orgunit-modify
                id="appscoOrgunitModify"
                authorization-token="[[ authorizationToken ]]"
                on-orgunit-added="_onOrgunitAdded"
                on-orgunit-modified="_onOrgunitModified"
                ></appsco-orgunit-modify>

        <appsco-orgunit-remove
                id="appscoOrgunitRemove"
                authorization-token="[[ authorizationToken ]]"
                on-orgunit-removed="_onOrgunitRemoved"
                ></appsco-orgunit-remove>

        <appsco-company-application-add
                id="appscoCompanyApplicationsAdd"
                authorization-token="[[ authorizationToken ]]"
                applications-template-api="[[ api.applicationTemplates ]]"
                add-application-api="[[ _companyApplicationsApi ]]"
                link-api="[[ api.link ]]"
                item-api="[[ api.item ]]"
                on-application-added="_onCompanyApplicationAdded"
                on-application-claims-updated="_onCompanyApplicationClaimsUpdated">
        </appsco-company-application-add>

        <appsco-company-sso-application-add
                id="appscoCompanySSOApplicationsAdd"
                authorization-token="[[ authorizationToken ]]"
                applications-template-api="[[ api.applicationTemplates ]]"
                add-application-api="[[ _companyApplicationsApi ]]"
                link-api="[[ api.link ]]"
                item-api="[[ api.item ]]"
                on-application-added="_onCompanyApplicationAdded"
                on-application-claims-updated="_onCompanyApplicationClaimsUpdated">
        </appsco-company-sso-application-add>

        <appsco-import-resources
                id="appscoImportResources"
                authorization-token="[[ authorizationToken ]]"
                import-api="[[ _companyImportResourcesApi ]]"
                on-import-finished="_onImportCompanyResourcesFinished"></appsco-import-resources>

        <appsco-application-orgunit
                id="appscoApplicationOrgunit"
                authorization-token="[[ authorizationToken ]]"
                company-orgunits-api="[[ _companyOrgunitsApi ]]"
                applications="[[ _selectedApplications ]]"
                on-added-to-orgunit="_onApplicationsAddedToOrgunit"></appsco-application-orgunit>

        <appsco-application-remove-orgunit
                id="appscoApplicationRemoveOrgunit"
                authorization-token="[[ authorizationToken ]]"
                application="[[ _companyApplication ]]"
                on-application-removed-from-orgunit="_onApplicationRemovedFromOrgunit"></appsco-application-remove-orgunit>

        <appsco-company-application-share
                id="appscoCompanyApplicationsShare"
                applications="[[ _applicationsToShare ]]"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-applications-shared="_onCompanyApplicationsShared"
                ></appsco-company-application-share>

        <appsco-application-assignee-claims
                id="appscoApplicationAssigneeClaims"
                application="[[ _companyApplication ]]"
                authorization-token="[[ authorizationToken ]]"
                on-claims-changed="_onAssigneeClaimsChanged"
                ></appsco-application-assignee-claims>

        <appsco-application-assignee-revoke
                id="appscoApplicationAssigneeRevoke"
                authorization-token="[[ authorizationToken ]]"
                on-access-revoked="_onAssigneeAccessRevoked"
                ></appsco-application-assignee-revoke>

        <appsco-company-application-remove
                id="appscoCompanyApplicationsRemove"
                applications="[[ _selectedApplications ]]"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                api-errors="[[ apiErrors ]]"
                on-applications-removed="_onApplicationsRemoved"
                on-applications-remove-failed="_onApplicationsRemoveFailed"></appsco-company-application-remove>

        <appsco-invitation-remove
                id="appscoInvitationRemove"
                authorization-token="[[ authorizationToken ]]"
                on-invitation-removed="_onInvitationRemoved"
                on-invitation-already-removed="_onInvitationAlreadyRemoved">
        </appsco-invitation-remove>

        <appsco-directory-add-account
                id="appscoDirectoryAccountAdd"
                authorization-token="[[ authorizationToken ]]"
                add-company-role-api="[[ _companyRolesApi ]]"
                add-invitation-api="[[ _companyInvitationsApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-company-role-created="_onCompanyRoleCreated"
                on-invitation-created="_onInvitationCreated">
        </appsco-directory-add-account>

        <appsco-import-accounts
                id="appscoDirectoryImportAccounts"
                authorization-token="[[ authorizationToken ]]"
                import-api="[[ _companyImportAccountsApi ]]"
                domain="[[ domain ]]"
                on-import-finished="_onAccountImportFinished">
        </appsco-import-accounts>

        <appsco-import-customer-resources
                id="appscoImportCustomerResources"
                authorization-token="[[ authorizationToken ]]"
                import-api="[[ _importCustomerResourcesApi ]]"
                domain="[[ domain ]]"
                on-import-finished="_onCustomerResourcesImportFinished">
        </appsco-import-customer-resources>

        <appsco-account-orgunit
                id="appscoAccountOrgunit"
                authorization-token="[[ authorizationToken ]]"
                company-orgunits-api="[[ _companyOrgunitsApi ]]"
                accounts="[[ _selectedAccounts ]]"
                on-added-to-orgunit="_onAccountsAddedToOrgunit"></appsco-account-orgunit>

        <appsco-account-remove-orgunit
                id="appscoAccountRemoveOrgunit"
                authorization-token="[[ authorizationToken ]]"
                account="[[ _role ]]"
                on-account-removed-from-orgunit="_onAccountRemovedFromOrgunit"></appsco-account-remove-orgunit>

        <appsco-account-remove-group
                id="appscoAccountRemoveGroup"
                authorization-token="[[ authorizationToken ]]"
                account="[[ _role ]]"
                on-account-removed-from-group="_onAccountRemovedFromGroup"></appsco-account-remove-group>

        <appsco-application-remove-group
                id="appscoApplicationRemoveGroup"
                authorization-token="[[ authorizationToken ]]"
                application="[[ application ]]"
                on-application-removed-from-group="_onApplicationRemovedFromGroup"></appsco-application-remove-group>

        <appsco-account-remove
                id="appscoAccountsRemove"
                accounts="[[ _selectedAccounts ]]"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-accounts-removed="_onAccountsRemoved"></appsco-account-remove>

        <appsco-contact-remove-group
                id="appscoContactRemoveGroup"
                authorization-token="[[ authorizationToken ]]"
                on-contact-removed-from-group="_onContactRemovedFromGroup"></appsco-contact-remove-group>

        <appsco-upgrade-action
                id="appscoUpgradeAction"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                on-subscription-changed="_onSubscriptionChanged">
        </appsco-upgrade-action>

        <appsco-subscription-cancel
                id="appscoSubscriptionCancel"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                on-subscription-canceled="_onSubscriptionCanceled">
        </appsco-subscription-cancel>

        <appsco-credit-card
                id="appscoCreditCard"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                on-credit-card-added="_onCreditCardAdded">
        </appsco-credit-card>

        <appsco-billing-send-invoice
                id="appscoBillingSendInvoice"
                company="[[ currentCompany ]]"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]"
                on-invoice-sent="_onInvoiceSent">
        </appsco-billing-send-invoice>

        <appsco-start-integration
                id="appscoStartIntegration"
                account="[[ account ]]"
                authorization-token="[[ authorizationToken ]]"
                company-api="[[ _companyApi ]]">
        </appsco-start-integration>

        <appsco-company-add-domain
                id="appscoCompanyAddDomain"
                authorization-token="[[ authorizationToken ]]"
                add-domain-api="[[ _companyDomainsApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-domain-added="_onDomainAdded"></appsco-company-add-domain>

        <appsco-company-remove-domain
                id="appscoCompanyRemoveDomain"
                authorization-token="[[ authorizationToken ]]"
                on-domain-removed="_onDomainRemoved"></appsco-company-remove-domain>

        <appsco-dialog-application-add
                id="appscoDialogApplicationAdd"
                authorization-token="[[ authorizationToken ]]"
                dashboard-api="[[ _addAppApi ]]"
                on-application-added="_onApplicationAdded"
        ></appsco-dialog-application-add>

        <appsco-dialog-application-company-add
                id="appscoDialogApplicationCompanyAdd"
                authorization-token="[[ authorizationToken ]]"
                add-application-api="[[ _companyApplicationsApi ]]"
                on-application-added="_onCompanyApplicationAdded"
                on-application-claims-updated="_onCompanyApplicationClaimsUpdated"
        ></appsco-dialog-application-company-add>

        <appsco-company-domain-token
                id="appscoCompanyDomainToken"></appsco-company-domain-token>

        <appsco-company-remove-group
                id="appscoCompanyRemoveGroup"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-group-removed="_onGroupRemoved"></appsco-company-remove-group>

        <appsco-remove-customer
                id="appscoRemoveCustomer"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-customer-removed="_onCustomerRemoved"></appsco-remove-customer>

        <appsco-resource-add-groups
                id="appscoShareToGroupDialog"
                authorization-token="[[ authorizationToken ]]"
                groups-api="[[ _companyGroupsApi ]]"
                on-groups-added-to-resources="_onGroupsAddedToResources"></appsco-resource-add-groups>

        <appsco-group-add-resource
                id="appscoGroupAddResource"
                group="[[ _group ]]"
                authorization-token="[[ authorizationToken ]]"
                on-resources-added-to-group="_onResourcesAddedToGroup"></appsco-group-add-resource>

        <appsco-resource-remove-from-group
                id="appscoResourceRemoveFromGroup"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-resource-removed-from-group="_onResourceRemovedFromGroup"></appsco-resource-remove-from-group>

        <appsco-customer-partner-admin-remove
                id="appscoCustomerPartnerAdminRemove"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-partner-admin-removed-from-customer="_onPartnerAdminRemovedFromCustomer"></appsco-customer-partner-admin-remove>

        <appsco-add-contact
                id="appscoAddContact"
                authorization-token="[[ authorizationToken ]]"
                add-contact-api="[[ _companyContactsApi ]]"
                add-invitation-api="[[ _companyInvitationsApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-contact-created="_onContactCreated"
                on-invitation-created="_onInvitationCreated"></appsco-add-contact>

        <appsco-import-contacts
                id="appscoImportContacts"
                authorization-token="[[ authorizationToken ]]"
                import-api="[[ _companyImportContactsApi ]]"
                domain="[[ domain ]]"
                on-import-finished="_onImportContactsFinished"></appsco-import-contacts>

        <appsco-company-add-group
                id="appscoCompanyAddGroup"
                authorization-token="[[ authorizationToken ]]"
                company-groups-api="[[ _companyGroupsApi ]]"
                api-errors="[[ _apiErrors ]]"></appsco-company-add-group>

        <appsco-convert-contact
                id="appscoConvertContact"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-contact-converted="_onContactConverted"></appsco-convert-contact>

        <appsco-delete-contact
                id="appscoDeleteContact"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-contact-deleted="_onContactDeleted"></appsco-delete-contact>

        <appsco-delete-contacts
                id="appscoContactsRemove"
                contacts="[[ _selectedContacts ]]"
                company-api="[[ _companyApi ]]"
                authorization-token="[[ authorizationToken ]]"
                on-contacts-removed="_onDeletedContacts"
                on-contacts-remove-failed="_onDeleteContactsFailed">
        </appsco-delete-contacts>

        <appsco-deactivate-idp-settings
                id="appscoDeactivateIdPSettings"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"
                on-idp-settings-deactivated="_onIdPSettingsDeactivated"></appsco-deactivate-idp-settings>

        <appsco-account-disable-2fa
                id="appscoAccountDisableTwoFa"
                two-fa-api="[[ api.twoFA ]]"
                authorization-token="[[ authorizationToken ]]"
                api-errors="[[ _apiErrors ]]"></appsco-account-disable-2fa>

        <appsco-add-customer
                id="appscoAddCustomer"
                authorization-token="[[ authorizationToken ]]"
                customers-api="[[ _companyCustomersApi ]]"
                roles-api="[[ _companyRolesApi ]]"
                check-if-customer-exists-api="[[ _checkIfCustomerExistsApi ]]"
                api-errors="[[ _apiErrors ]]"
                on-customer-added="_onCustomerAdded"></appsco-add-customer>

        <appsco-add-partner-admin-to-customers
                id="appscoAddPartnerAdmin"
                authorization-token="[[ authorizationToken ]]"
                partner-admins-api="[[ _customerPartnerAdminsApi ]]"
                roles-api="[[ _companyRolesApi ]]"
                customers="[[ _selectedCustomers ]]"
                api-errors="[[ _apiErrors ]]"
                on-partner-admin-added="_onPartnerAdminAdded"></appsco-add-partner-admin-to-customers>

        <appsco-remove-customers
                id="appscoCustomersRemove"
                customers="[[ _selectedCustomers ]]"
                customers-api="[[ _companyCustomersApi ]]"
                authorization-token="[[ authorizationToken ]]"
                on-customers-removed="_onRemovedCustomers"
                on-customers-remove-failed="_onRemovedCustomersFailed">
        </appsco-remove-customers>

        <appsco-import-customers
                id="appscoImportCustomers"
                authorization-token="[[ authorizationToken ]]"
                import-api="[[ _importCustomersApi ]]"
                domain="[[ domain ]]"
                on-import-finished="_onCustomersImportFinished"></appsco-import-customers>

        <template is="dom-if" if="[[ api.me ]]">
            <iron-ajax auto
                       id = "getAccountRequest"
                       url="[[ api.me ]]"
                       on-response="_onGetAccountResponse"
                       on-error="_onGetAccountError"
                       headers="[[ _computedHeaders ]]"></iron-ajax>

            <iron-ajax auto
                       id="getCompaniesAccountIsContactIn"
                       url="[[ api.companiesAccountIsContactInApi ]]"
                       on-response="_onGetCompaniesAccountIsContactInApiResponse"
                       headers="[[ _computedHeaders ]]"></iron-ajax>
        </template>

        <template is="dom-if" if="[[ api.dashboards ]]">
            <iron-ajax id="getDashboardsLink"
                       url="[[ api.dashboards ]]?extended=1"
                       on-response="_onDashboardsResponse"
                       headers="[[ _computedHeaders ]]"></iron-ajax>
        </template>

        <iron-ajax auto
                   url="[[ _companySubscriptionApi ]]"
                   headers="[[ _computedHeaders ]]"
                   handle-as="json"
                   on-response="_onSubscriptionResponse"></iron-ajax>
    </template>

    <script>
        Polymer({
            is: 'appsco-app',

            properties: {

                _companyPage: {
                    type: Boolean,
                    computed: '_computeCompany(page)'
                },

                _contactPage: {
                    type: Boolean,
                    computed: '_computeContactPage(page)'
                },

                page: {
                    type: String,
                    observer: '_pageChanged'
                },

                _prefixPath: {
                    type: String,
                    computed: '_computePrefixPath(domain)'
                },

                domain: {
                    type: String
                },

                language: {
                    value: 'en',
                    type: String
                },

                _pageName: {
                    type: String,
                    computed: '_computePageName(page)'
                },

                api: {
                    type: Object,
                    value: function () { return {}; },
                    notify: true
                },

                _apiErrors: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                account: {
                    type: Object,
                    value: function() {
                        return {};
                    },
                    notify: true
                },

                _accountManaged: {
                    type: Boolean,
                    computed: '_computeAccountManagedState(account, currentCompany)'
                },

                _role: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                _group: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                /**
                 * Computed headers.
                 * It contains authorization token.
                 */
                _computedHeaders: {
                    type: Object,
                    computed: "_computeHeaders(authorizationToken)"
                },

                chat: {
                    type: Object,
                    value: function() {
                        return {
                            auth: "auth code",
                            room: "room number",
                            service: "https://www.xxx.com",
                            active: "false"
                        }
                    }
                },

                /**
                 * Selected application.
                 */
                application: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                currentCompany: {
                    type: Object,
                    value: function() {
                        return {};
                    },
                    notify: true,
                    observer: '_onCurrentCompanyChanged'
                },

                _companiesAccountIsContactIn: {
                    type: Array,
                    value: function() {
                        return [];
                    }
                },

                _companiesAccountHasPermissionTo: {
                    type: Array,
                    computed: '_computeCompaniesAccountHasPermissionTo(account, _companiesAccountIsContactIn)'
                },

                /**
                 * Selected company application.
                 */
                _companyApplication: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                /**
                 * Selected applications (company).
                 */
                _selectedApplications: {
                    type: Array,
                    value: function() {
                        return [];
                    }
                },

                /**
                 * Company applications to share.
                 */
                _applicationsToShare: {
                    type: Array,
                    value: function() {
                        return [];
                    }
                },

                /**
                 * Selected authorized application that is to be removed.
                 */
                _authorizedApplication: {
                    type: Object,
                    value: function() {
                        return {};
                    },
                    notify: true
                },

                /**
                 * Selected accounts (company).
                 */
                _selectedAccounts: {
                    type: Array,
                    value: function() {
                        return [];
                    }
                },

                /**
                 * Selected contacts.
                 */
                _selectedContacts: {
                    type: Array,
                    value: function() {
                        return [];
                    }
                },

                /**
                 * Selected customers.
                 */
                _selectedCustomers: {
                    type: Array,
                    value: function() {
                        return [];
                    }
                },

                /**
                 * Selected integration for provisioning settings
                 */
                _selectedIntegration: {
                    type: Object,
                    value: function() { return {}; }
                },

                /**
                 * Authorization token for logged account.
                 */
                authorizationToken: {
                    type: String,
                    value: ''
                },

                _addAppApi: {
                    type: String,
                    value: ''
                },

                _applicationsApi: {
                    type: String,
                    value: ''
                },

                _companyAdmin: {
                    type: Boolean,
                    computed: '_computeCompanyAdmin(currentCompany)'
                },

                _companyContact: {
                    type: Boolean,
                    computed: '_computeCompanyContact(currentCompany)'
                },

                _companyApi: {
                    type: String,
                    value: ''
                },

                _companyIconsApi: {
                    type: String,
                    value: ''
                },

                _companyApplicationsApi: {
                    type: String,
                    value: ''
                },

                _companyImportResourcesApi: {
                    type: String,
                    computed: '_computeCompanyImportResourcesApi(_companyApplicationsApi)'
                },

                _companyInvitationsApi: {
                    type: String,
                    value: ''
                },

                _companyRolesApi: {
                    type: String,
                    value: ''
                },

                _companyImportAccountsApi: {
                    type: String,
                    value: ''
                },

                _companyContactsApi: {
                    type: String,
                    value: ''
                },

                _companyImportContactsApi: {
                    type: String,
                    computed: '_computeCompanyImportContactsApi(_companyContactsApi)'
                },

                _companyCustomersExportApi: {
                    type: String,
                    computed: '_computeCompanyExportCustomersApi(_companyCustomersApi)'
                },

                _companyOrgunitsApi: {
                    type: String,
                    value: ''
                },

                _companySubscriptionApi: {
                    type: String,
                    value: ''
                },

                _companyDomainsApi: {
                    type: String,
                    value: ''
                },

                _companyGroupsApi: {
                    type: String,
                    value: ''
                },

                _companyGroupApi: {
                    type: String,
                    value: ''
                },

                _companySamlMetadataApi: {
                    type: String,
                    value: ''
                },

                _companyAuditLogApi: {
                    type: String,
                    value: ''
                },

                _companyCustomersApi: {
                    type: String,
                    value: ''
                },

                _customerPartnerAdminsApi: {
                    type: String,
                    computed: '_computeCustomerPartnerAdminApi(_companyCustomersApi)'
                },

                _importCustomerResourcesApi: {
                    type: String,
                    computed: '_computeCustomerResourcesImportApi(_companyCustomersApi)'
                },

                _partnerApi: {
                    type: String,
                    value: ''
                },

                _importCustomersApi: {
                    type: String,
                    computed: '_computeImportCustomersApi(_companyCustomersApi)'
                },

                _checkIfCustomerExistsApi: {
                    type: String,
                    computed: '_computeCheckIfCustomerExistsApi(_partnerApi)'
                },

                _getAccessReportApi: {
                    type: String,
                    value: ''
                },

                _exportAccessReportApi: {
                    type: String,
                    computed: '_computeExportAccessReportApi(_getAccessReportApi)'
                },

                _subscription: {
                    type: Object,
                    value: function() {
                        return {};
                    }
                },

                _globalActions: {
                    type: Boolean,
                    value: true
                },

                _selectedApplicationsGroup: {
                    type: Number,
                    value: 0
                },

                _toastMessage: {
                    type: String,
                    value: ''
                },

                _toastPersistence: {
                    type: Boolean,
                    value: false
                },

                mobileScreen: {
                    type: Boolean,
                    value: false,
                    reflectToAttribute: true
                },

                tabletScreen: {
                    type: Boolean,
                    value: false,
                    reflectToAttribute: true
                },

                _companyUser: {
                    type: Boolean,
                    computed: "_computeCompanyUser(currentCompany)"
                },

                _brandLogo: {
                    type: String,
                    computed: '_computeBrandLogo(currentCompany, _companyPage)'
                },

                _brandTitle: {
                    type: String,
                    computed: '_computeBrandTitle(currentCompany, _companyPage)'
                },

                _contactIconsApi: {
                    type: String,
                    computed: '_computeContactIconsApi(domain, currentCompany)'
                }
            },

            observers: [
                '_updateScreen(mobileScreen, tabletScreen)',
                '_routePageChanged(routeData.page)',
                '_changeTheme(_companyPage, currentCompany)',
                '_redirectToCompany(page, currentCompany, account)',
                '_setupCompanyAccountPage(page, account)',
                '_handlePagePermission(currentCompany, page)'
            ],

            listeners: {
                'page-global-info': '_onInfoAction',
                'page-global-filters': '_onFiltersAction',
                'page-loaded': '_onPageLoaded',
                'filter-done': '_onPageLoaded',
                'upgrade-active': '_fireUpgrade',
                'cancel-subscription': '_onCancelSubscription',
                'reload-account-log': '_onReloadAccountLog',
                'info-edit-application-credentials': '_onEditApplicationCredentials',
                'reload-applications': '_onReloadApplications',
                'reload-accounts': '_onReloadAccounts',
                'application-settings-saved': '_onApplicationUpdated',
                'show-subscription-limit-reached-info': '_onShowSubscriptionLimitReachedInfo',
                'copied-application-attribute': '_onCopiedApplicationAttribute',
                'group-added': '_onGroupAdded',
                'remove-invitation': '_onRemoveInvitationAction',
                'reload-contacts': '_onReloadContacts',
                'change-assignee-claims': '_onChangeAssigneeClaims',
                'enable-advanced-settings': '_onEnableAccountAdvancedSettings',
                'disable-advanced-settings': '_onDisableAccountAdvancedSettings',
                'twofa-enabled': '_onTwoFaEnabled',
                'disable-twofa': '_onDisableTwoFaAction',
                'twofa-disabled': '_onTwoFaDisabled',
                'revoke-authorized-application': '_onRevokeAuthorizedApplication',
                'token-generated': '_onTokenGenerated',
                'reset-page-actions': '_onResetPageActions',
                'export-access-report': '_onExportAccessReportAction',
                'export-access-report-finished': '_onExportAccessReportFinished',
                'export-access-report-failed': '_onExportAccessReportFailed'
            },

            attached: function() {

                if (this.mobileScreen || this.tabletScreen) {
                    this.updateStyles();
                }

            },

            _updateScreen: function(mobile, tablet) {
                this.updateStyles();
            },

            _computePrefixPath: function (domain) {

                if(window.location.href.includes('localhost')) {
                    return '';
                }

                if (domain.includes('/app.php')) {
                    return '/app.php';
                }

                if (domain.includes('/app_dev.php')) {
                    return '/app_dev.php';
                }

                return '';
            },

            _onCurrentCompanyChanged: function(company, oldCompany) {

                if (company && company.company) {

                    for (key in company.company) {
                        document.cookie = 'company=' + company.company.alias;

                        this._setCompanyApi(company);
                        this._setProduct(this._companyPage);

                        if (oldCompany && oldCompany.company
                            && company.company.personal_dashboards_allowed !== oldCompany.company.personal_dashboards_allowed) {
                            this._getLoggedAccount();
                        }

                        return false;
                    }
                }
                else {
                    this._setProduct(false);
                }
            },

            _redirectToCompany: function(page, currentCompany, account) {
                if (account.self && currentCompany.company && page) {
                    this._checkPersonalDashboardPermission(page, account);
                }
            },

            _computeCompanyUser: function(currentCompany) {
                return currentCompany && !currentCompany.company_contact;
            },

            _computeCompanyAdmin: function(company) {
                return company.company_admin;
            },

            _computeCompanyContact: function(company) {
                return company.company_contact;
            },

            _computeCompaniesAccountHasPermissionTo: function(account, companiesAccountIsContactIn) {
                var companies = (account.companies && 0 < account.companies.length) ? account.companies : [];
                return (0 < companiesAccountIsContactIn.length) ? companies.concat(companiesAccountIsContactIn) : companies;
            },

            _setProduct: function(company) {
                var appscoHeader = this.$.appscoHeader;

                company ? appscoHeader.setProduct('appsco-business-product' + this.currentCompany.company.alias) : appscoHeader.setProduct('appsco-product');
            },

            _handlePagePermission: function(company, page) {

                for (key in company) {

                    switch (page) {
                        case 'customers':
                            if (!this.currentCompany.company.is_partner) {
                                this._showCompanyHomePage();
                            }

                            break;

                        default:
                            return false;
                    }

                    return false;
                }
            },

            /**
             * Routing START
             */
            _routePageChanged: function(page) {
                this._brandLogoClickable = !('home' == page || 'company-home' == page);
                this.page = page || 'home';
            },

            _pageChanged: function(page) {
                this._setProgressBar(page);
                this._closeToastMessage();

                // Load page import on demand. Show 404 page if fails
                var resolvedPageUrl = this.resolveUrl('appsco-' + page + '-page.html');

                this.importHref(resolvedPageUrl, null, this._showPage404, true);

                this.$.appDrawer.close();
            },

            _computePageName: function(page) {

                switch (page) {
                    case 'manage-resource':
                        return 'Manage Resource';

                    case 'manage-account':
                        return 'Manage Account';

                    case 'manage-contact':
                        return 'Manage Contact';

                    case 'manage-customer':
                        return 'Manage Customer';

                    case 'manage-group':
                        return 'Manage Group';

                    case 'company-home':
                        return 'Dashboard';

                    case 'contact-home':
                        return 'Dashboard';

                    case 'access-report':
                        return 'Access report';

                    case 'company':
                        return 'Company Settings';

                    case 'provisioning-settings':
                        return 'Provisioning > Setup';

                    case 'provisioning-integration-authorization-success':
                        return 'Provisioning > Authorization success';

                    case 'provisioning-integration-authorization-failed':
                        return 'Provisioning > Authorization failed';

                    case 'audit-log':
                        return 'Audit Log';

                    case 'trybusiness':
                        return 'Try Appsco Business';

                    case 'company-account':
                        return 'Account';

                    default:
                        return page;
                }

            },

            _onMenuItemSelected: function(event) {
                this._showPage(event.detail.item.name);
            },

            _showPage: function(name) {
                this.set('routeData.page', name);
            },

            _showManagePage: function(path) {
                this.set('route.path', this._prefixPath + '/' + path);
            },

            _showHomePage: function() {
                this._showPage('home');
            },

            _showVaultPage: function() {
                this._showPage('vault');
            },

            _showAccountPage: function() {
                this._showPage('account');
            },

            _showCompanyAccountPage: function() {
                this._showPage('company-account');
            },

            _showTryBusinessPage: function() {
                this._showPage('trybusiness');
            },

            _showCompanyHomePage: function() {
                this._showPage('company-home');
            },

            _showCompanyPage: function() {
                this._showPage('company');
            },

            _showCompanyResourcesPage: function() {
                this._showPage('resources');
            },

            _showCompanyDirectoryPage: function() {
                this._showPage('directory');
            },

            _showContactsPage: function() {
                this._showPage('contacts');
            },

            _showCustomersPage: function() {
                this._showPage('customers');
            },

            _showGroupsPage: function() {
                this._showPage('groups');
            },

            _showCompanyProvisioningPage: function() {
                this._showPage('provisioning');
            },

            _showLogoutPage: function() {
                this._showPage('logout');
            },

            _showContactHomePage: function() {
                this._showPage('contact-home');
            },

            _showReportsPage: function() {
                this._showPage('reports');
            },

            _showAccessReportPage: function() {
                this._showPage('access-report');
            },

            _showPage404: function() {
                this.page = '404';
                this._pageName = 'Not Found';
            },
            /**
             * Routing END
             */

            /**
             * Ajax START
             */
            /**
             * Computes authorization headers.
             *
             * @param {Object} authorizationToken
             * @returns {{ Authorization: string }}
             * @private
             */
            _computeHeaders: function (authorizationToken) {
                return {
                    'Authorization': 'token ' + authorizationToken
                }
            },

            _setCompanyApi: function(company) {
                var companyApi = company.company.self,
                    partnerApi = companyApi.replace('companies', 'partners');

                this._companyApi = companyApi;
                this._companyIconsApi = company.icons;
                this._partnerApi = partnerApi;

                if (company.company_admin) {
                    this._companyApplicationsApi = companyApi + '/applications';
                    this._companyRolesApi = companyApi + '/directory/roles';
                    this._companyInvitationsApi = companyApi + '/invitation';
                    this._companyImportAccountsApi = companyApi + '/directory/roles/import';
                    this._companyContactsApi = companyApi + '/contacts';
                    this._companyOrgunitsApi = companyApi + '/org-units?extended=1';
                    this._companySubscriptionApi = companyApi + '/billing/subscription';
                    this._companyDomainsApi = companyApi + '/domains';
                    this._companyGroupsApi = companyApi + '/groups';
                    this._companyGroupApi = companyApi + '/group';
                    this._companySamlMetadataApi = companyApi + '/idp/saml/metadata';
                    this._companyAuditLogApi = companyApi + '/log';
                    this._companyCustomersApi = partnerApi + '/customers';
                    this._getAccessReportApi = companyApi + '/reports/application-access';
                }
            },

            _computeCompanyImportResourcesApi: function(companyApplicationsApi) {
                return companyApplicationsApi ? (companyApplicationsApi + '/import') : '';
            },

            _computeCompanyImportContactsApi: function(contactsApi) {
                return contactsApi ? (contactsApi + '/import') : '';
            },

            _computeImportCustomersApi: function(customersApi) {
                return customersApi ? (customersApi + '/import') : '';
            },

            _computeCheckIfCustomerExistsApi: function(partnerApi) {
                return partnerApi ? (partnerApi + '/customer/exists') : '';
            },

            _computeCustomerResourcesImportApi: function(customersApi) {
                return customersApi ? customersApi + '/import-resources' : '';
            },

            _computeCompanyExportCustomersApi: function(customersApi) {
                return customersApi ? customersApi + '/export' : '';
            },

            _computeCustomerPartnerAdminApi: function(customersApi) {
                return customersApi ? customersApi + '/partner-admins' : '';
            },

            _computeExportAccessReportApi: function(getAccessReportApi) {
                return getAccessReportApi ? (getAccessReportApi + '/export') : '';
            },

            _getLoggedAccount: function() {
                this.$$('#getAccountRequest').generateRequest();
            },

            _onGetAccountResponse: function(event) {
                var account = event.detail.response.account;

                this.set('account', {});
                this.set('account', account);
                this.$$('#getDashboardsLink').generateRequest();
                this.$$('#getCompaniesAccountIsContactIn').generateRequest();
                setTimeout(function() {
                   this._getCurrentCompanyFromAccount();
                }.bind(this), 400);


            },

            _getCurrentCompanyFromAccount: function() {
                if (this._companiesAccountHasPermissionTo.length > 0) {
                    var companies = this._companiesAccountHasPermissionTo,
                            length = companies.length,
                            currentCompany = companies[0],
                            companyAlias = this._getCookie('company');

                    if (companyAlias && companyAlias.length > 0) {

                        for (var i = 0; i < length; i++) {
                            if (companies[i].company.alias == companyAlias) {
                                currentCompany = companies[i];
                            }
                        }
                    }

                    this.currentCompany = currentCompany;
                }
            },

            _computeContactIconsApi: function(domain, currentCompany) {
                if (currentCompany.company && currentCompany.company_contact) {
                    return domain + '/api/v2/me/contact/companies/' + currentCompany.company.alias + '/apps';
                }
            },

            /**
             * Checks is user allowed to see personal dashboard pages
             *
             * @param {String} page
             * @param {Object} account
             *
             * @private
             */
            _checkPersonalDashboardPermission: function(page, account) {
                if (!account.personal_dashboard_allowed) {
                    this._disablePersonalDashboard(page);
                } else {
                    this._enablePersonalDashboard(page);
                }
            },

            /**
             * Remove personal from product list, and redirect user to company page if needed
             *
             * @param {String} page
             *
             * @private
             */
            _disablePersonalDashboard: function(page) {
                this.$.appscoHeader.removeProduct('appsco-product');
                this._setProduct(true);

                if (this._isPersonalPage(page)) {
                    this._showCompanyHomePage();
                }
            },

            /**
             * Returns Personal to product list
             *
             * @private
             */
            _enablePersonalDashboard: function(page) {
                this.$.appscoHeader.addPersonalToProducts();
                this._setProduct(!this._isPersonalPage(page));
            },

            /**
             * Returns true if page is on personal dashboard
             *
             * @param {String} page
             * @returns {Boolean}
             *
             * @private
             */
            _isPersonalPage: function(page) {
                var personalPages = ['home', 'vault', 'trybusiness', 'account'];
                return personalPages.indexOf(page) != -1;
            },

            _onGetAccountError: function() {
//                this._showPage404();
            },

            _onGetCompaniesAccountIsContactInApiResponse: function(event) {
                var response = event.detail.response;

                if (response.companies && 0 < response.companies.length) {
                    this.set('_companiesAccountIsContactIn', response.companies.map(function(company) {
                        return {
                            company: company,
                            company_contact: true
                        };
                    }));
                }
            },

            _setGetApplicationsApi: function() {
                this._applicationsApi = this.api.icons;
            },

            _createDefaultDashboard: function() {
                var request = document.createElement('iron-request'),
                    options = {
                        url: this.api.dashboards,
                        method: 'POST',
                        handleAs: 'json',
                        headers: {
                            'Authorization': 'token ' + this.authorizationToken,
                            'Content-Type': 'application/x-www-form-urlencoded'
                        },
                        body: 'dashboard[title]=' + encodeURIComponent(this.account.name)
                    };

                request.send(options).then(function() {

                    if (200 == request.status) {
                        this._addAppApi = request.response.dashboard.self;
                        this._setGetApplicationsApi();
                    }

                }.bind(this));
            },

            _onDashboardsResponse: function(event) {
                var response = event.detail.response;

                if (response && response.meta.total > 0) {
                    var dashboards = response.dashboards,
                        length = dashboards.length,
                        hasDashboard = false;

                    dashboardsLoop:
                    for (var i = 0; i < length; i++) {
                        var dashboardRoles = dashboards[i].roles,
                            rolesLength = dashboardRoles.length;

                        for (var j = 0; j < rolesLength; j++) {
                            if ('owner' === dashboardRoles[j].toLowerCase()) {
                                this._addAppApi = dashboards[i].self;
                                this._setGetApplicationsApi();
                                hasDashboard = true;
                                break dashboardsLoop;
                            }
                        }

                    }

                    if (!hasDashboard) {
                        this._createDefaultDashboard();
                    }
                }
                else {
                    this._createDefaultDashboard();
                }
            },

            _onSubscriptionResponse: function(event) {
                var status = event.detail.status,
                    response = event.detail.response;

                if (200 === status && response) {
                    this._subscription = response;
                    this._setSubscription(response);
                    this._evaluateSubscriptionLicences();
                }
            },

            _computeAccountManagedState: function(account) {
                return !!account.native_company;
            },
            /**
             * Ajax END
             */

            /**
             * Appsco header actions START
             */
            _onBrandAction: function() {
                this._companyPage ? this._showCompanyHomePage() : this._showHomePage();
            },

            _onVaultAction: function() {
                this._setProduct(false);
                this._showVaultPage();
            },

            _onAppscoProductChangeAction: function(event) {
                var panel = event.detail.product,
                    company = event.detail.company;

                if ('appsco-product' === panel && 'home' !== this.page) {
                    this._showHomePage();
                }

                if ('appsco-business-product' === panel) {
                    this.currentCompany = company;

                    company.company_contact ? this._showContactHomePage() : this._showCompanyHomePage();
                }

            },

            _onAccountChat: function(event) {
                this.$.appscoAccountChat.toggleChat(event.target);
            },

            _onAccountSettingsAction: function() {
                this._setProduct(this._accountManaged);

                this._accountManaged ? this._showCompanyAccountPage() : this._showAccountPage();
            },

            _onAllNotifications: function() {
                this._setProduct(this._accountManaged);

                if (this._accountManaged) {
                    this.$.appscoCompanyAccountPage.showAllNotifications = true;
                    this._showCompanyAccountPage();
                }
                else {
                    this.$.appscoAccountPage.showAllNotifications = true;
                    this._showAccountPage();
                }
            },

            _onAccountLogout: function() {
                this._showLogoutPage();
            },
            /**
             * Appsco header actions END
             */

            /**
             * Home page START
             */
            _onLoadedPage: function(event) {
                var page = event.currentTarget;

                if (page.$ && ('home' === this.page || 'company-home' === this.page || 'resources' === this.page || 'contact-home' === this.page)) {
                    page.initializePage();
                }
            },

            getCurrentAppscoPageElement: function() {
                switch (this.page) {
                    case 'home':
                        return this.$.appscoHomePage;
                        break;

                    case 'company-home':
                        return this.$.appscoCompanyHomePage;
                        break;

                    case 'resources':
                        return this.$.appscoResourcesPage;
                        break;

                    case 'directory':
                        return this.$.appscoDirectoryPage;
                        break;

                    case 'company':
                        return this.$.appscoCompanyPage;
                        break;

                    case 'vault':
                        return this.$.appscoVaultPage;
                        break;

                    case 'contacts':
                        return this.$.appscoContactsPage;
                        break;

                    case 'groups':
                        return this.$.appscoGroupsPage;
                        break;

                    case 'account':
                        return this.$.appscoAccountPage;
                        break;

                    case 'company-account':
                        return this.$.appscoCompanyAccountPage;
                        break;

                    case 'contact-home':
                        return this.$.appscoContactHomePage;
                        break;

                    case 'customers':
                        return this.$.appscoCustomersPage;
                        break;

                    case 'reports':
                        return this.$.appscoReportsPage;
                        break;

                    case 'access-report':
                        return this.$.appscoAccessReportPage;
                        break;
                }
            },

            getCurrentAppscoPageActionsElement: function() {

                switch (this.page) {
                    case 'home':
                        return this.$.appscoHomePageActions;
                        break;

                    case 'resources':
                        return this.$.appscoResourcesPageActions;
                        break;

                    case 'directory':
                        return this.$.appscoDirectoryPageActions;
                        break;

                    case 'contacts':
                        return this.$.appscoContactsPageActions;
                        break;

                    case 'groups':
                        return this.$.appscoGroupsPageActions;
                        break;

                    case 'account':
                        return this.$.appscoAccountPageActions;
                        break;

                    case 'company-account':
                        return this.$.appscoCompanyAccountPageActions;
                        break;

                    case 'customers':
                        return this.$.appscoCustomersPageActions;
                        break;
                }

            },

            _onInfoAction: function() {
                this.getCurrentAppscoPageElement().toggleInfo();
            },

            _onFiltersAction: function() {
                this.getCurrentAppscoPageElement().toggleResource();
            },

            _onShowBulkActions: function() {
                this.getCurrentAppscoPageActionsElement().showBulkActions();
            },

            _onHideResourcesBulkActions: function() {
                this.$.appscoResourcesPageActions.hideBulkActions();
            },

            _onHideContactBulkActions: function() {
                this.$.appscoContactsPageActions.hideBulkActions();
            },

            _onHideDirectoryBulkActions: function() {
                this.$.appscoDirectoryPageActions.hideBulkActions();
            },

            _onInfoVaultAction: function() {
                this.$.appscoVaultPage.toggleInfo();
            },

            _onSearchApplications: function(event) {
                this._showProgressBar();
                this.getCurrentAppscoPageElement().filterApplicationsByTerm(event.detail.term);
            },

            _onSearchApplicationsClear: function() {
                this.getCurrentAppscoPageElement().filterApplicationsByTerm('');
            },

            _onFilterItems: function(event) {
                var id = parseInt(event.detail.id);

                if (id !== this._selectedApplicationsGroup) {
                    this._selectedApplicationsGroup = id;
                    this._showProgressBar();

                    switch (id) {
                        case 0:
                            this._applicationsApi = this.api.icons;
                            break;

                        case 1:
                            this._applicationsApi = this.api.personalItems;
                            break;

                        case 2:
                            this._applicationsApi = this.api.sharedWithMeItems;
                            break;

                        default:
                            return false;
                    }
                }

            },

            _onAddItemAction: function(event) {
                var action = event.detail.action,
                    applicationTemplate = event.detail.applicationTemplate;

                switch (action) {
                    case 'catalogue-application':
                        this.$.appscoApplicationAdd.toggle();
                        break;
                    default:
                        var request = document.createElement('iron-request'),
                            options = {
                                url: this.domain + applicationTemplate,
                                method: 'GET',
                                handleAs: 'json',
                                headers: {
                                    'Authorization': 'token ' + this.authorizationToken
                                }
                            };

                        request.send(options).then(function() {

                            if (200 == request.status) {
                                this.$.appscoDialogApplicationAdd.setApplicationTemplate(request.response.application);
                                this.$.appscoDialogApplicationAdd.toggle();
                            }

                        }.bind(this));
                        break;
                }
            },

            _onApplicationAdded: function(event) {
                var application = event.detail.application,
                    applications = [application],
                    message = application.title + ' was successfully saved.';

                this.application = application;
                this.$.appscoHomePage.addApplications(applications);
                this._notify(message);
            },

            _onEditApplication: function() {
                this._showManagePage('resource/' + this.application.alias);
            },

            _onInfoEditApplication: function() {
                this._onEditApplication();
            },

            _onEditApplicationCredentials: function(event) {
                this.$.appscoApplicationSettingsDialog.setApplication(event.detail.application);
                this.$.appscoApplicationSettingsDialog.toggle();
            },

            _reloadHomePageApplications: function() {

                if (this.$.appscoHomePage.$) {
                    this.$.appscoHomePage.reloadApplications();
                }
            },
            /**
             * Home page END
             */

            /**
             * Resource page START
             */
            _onApplicationUpdated: function(event) {
                var application = event.detail.application;

                switch (this.page) {
                    case 'home':
                    case 'resource':
                        this.set('application', {});
                        this.set('application', application);

                        if (this.$.appscoHomePage.$) {
                            this.$.appscoHomePage.setApplication(application);
                        }

                        break;

                    case 'company-home':
                        this.set('_companyApplication', {});
                        this.set('_companyApplication', application);

                        if (this.$.appscoCompanyHomePage.$) {
                            this.$.appscoCompanyHomePage.setApplication(application);
                        }

                        this._reloadCompanyApplications();

                        break;

                    case 'contact-home':
                        this.set('_companyApplication', {});
                        this.set('_companyApplication', application);

                        if (this.$.appscoContactHomePage.$) {
                            this.$.appscoContactHomePage.setApplication(application);
                        }

                        this._reloadCompanyApplications();

                        break;

                    case 'manage-resource':
                        this.set('_companyApplication', {});
                        this.set('_companyApplication', application);

                        this._reloadCompanyHomePageApplications();
                        this._reloadCompanyApplications();

                        break;
                }
            },

            _onResourceActionApplicationPage: function() {
                this.$.appscoApplicationPage.toggleResource();
            },

            _onEnableSubscribersSearchAction: function() {
                this.$.appscoApplicationPageActions.enableSubscribersSearchAction();
            },

            _onDisableSubscribersSearchAction: function() {
                this.$.appscoApplicationPageActions.disableSubscribersSearchAction();
            },

            _searchSubscribers: function(term) {
                this._showProgressBar();
                this.$.appscoApplicationPage.searchSubscribers(term);
            },

            _onSearchSubscribers: function(event) {
                this._searchSubscribers(event.detail.term);
            },

            _onSearchSubscribersClear: function() {
                this._searchSubscribers('');
            },

            _onShareApplication: function() {
                this.$.appscoApplicationShare.toggle();
            },

            _onApplicationShared: function(event) {
                var application = event.detail.application,
                    succeded = event.detail.succeded,
                    failed = event.detail.failed,
                    applicationLogApi = application.meta.log,
                    message = '';

                if (parseInt(succeded) != 0) {
                    message = 'Application ' + this.application.title + ' was successfully shared to ' + succeded + ' accounts.';
                }

                if (parseInt(failed) != 0) {
                    message = (0 != message.length) ?
                        message + ' It was already shared to ' + failed + ' selected accounts. ' :
                        'Application ' + this.application.title + ' was already shared to ' + failed + ' selected accounts.';
                }

                // In order to notify.
                this.set('application', {});
                this.set('application', application);

                this._notifyAboutApplicationLogChange(applicationLogApi);
                this._notify(message, true);
            },

            _onApplicationCredentialsChanged: function(event) {
                var application = event.detail.application,
                    message = 'You successfully changed ' + application.title + ' credentials.';

                this._notify(message);
            },

            _onRemoveApplication: function() {
                this.$.appscoApplicationRemove.open();
            },

            _onApplicationRemoved: function(event) {
                var application = event.detail.application,
                    applications = [application],
                    message = application.title + ' was successfully removed.';

                if (this.$.appscoHomePage.$) {
                    this.$.appscoHomePage.removeApplications(applications);
                } else {
                    this._showHomePage();
                }

                this._notify(message);

                this._notifyAccountLog();
            },

            _onApplicationSettingsSaved: function(event) {
                var application = event.detail.application,
                    applicationLogApi = application.meta.log,
                    message = application.title + ' was successfully changed.';

                this._notifyAboutApplicationLogChange(applicationLogApi);
                this._notify(message);
            },

            _onApplicationSettingsNoChanges: function(event) {
                this._notify('No changes have been made to ' + event.detail.application.title + '.');
            },

            _onAutologinChanged: function() {
                this._notifyReloadApplications();
            },

            _onReloadApplications: function() {

                switch (this.page) {
                    case 'resource':
                        this._reloadHomePageApplications();

                        break;

                    case 'resources':
                        this._reloadHomePageApplications();
                        this._reloadCompanyHomePageApplications();
                        this._reloadContactHomePageApplications();

                        break;

                    case 'manage-resource':
                        this._reloadCompanyApplications();
                        this._reloadCompanyHomePageApplications();
                        this._reloadContactHomePageApplications();

                        break;
                }

            },

            /**
             * Notifies application log api change.
             * Used to notify appsco-application-log to load log again.
             *
             * @param String applicationLogApi
             * @private
             */
            _notifyAboutApplicationLogChange: function(applicationLogApi) {
                this.set('application.meta.log', '');
                this.set('application.meta.log', applicationLogApi);
            },

            _onSubscriptionRevoke: function(event) {
                this.$.appscoApplicationSubscriberRevoke.application =   event.detail.application;
                this.$.appscoApplicationSubscriberRevoke.revokeAccount = event.detail.account;

                this.$.appscoApplicationSubscriberRevoke.open();
            },

            _onRevokeApplication: function(event) {
                this.$.appscoApplicationRevoke.applicationInstance = event.detail.application;
                this.$.appscoApplicationRevoke.open();
            },

            _onSelfSubscriptionRevoked: function(event) {
                this.$.appscoHomePage.removeApplications([event.detail.application]);
                this.$.appscoHomePage.setDefaultApplication();
                this._notify('You have successfully revoked access to ' + event.detail.application.title + '.');
            },

            _onAccountSubscriptionRevoked: function(event) {
                this.set('application', {});
                this.set('application', event.detail.application);
                this._notify('You have successfully revoked access to ' + event.detail.application.title + ' for ' + event.detail.account.name);
            },

            _onSubscriptionRevoked: function(event) {

                switch (this.page) {
                    case 'home':
                        this._onSelfSubscriptionRevoked(event);
                        break;

                    case 'resource':
                        this._onAccountSubscriptionRevoked(event);
                        break;
                }

            },

            _onApplicationInstanceRevoked: function(event) {
                this.$.appscoHomePage.removeApplications([event.detail.applicationInstance]);
                this.$.appscoHomePage.setDefaultApplication();
                this._notify('You have successfully revoked access to ' + event.detail.applicationInstance.application.title + '.');

            },

            _onApplicationsRemovedFromHomePage: function() {
                this._showHomePage();

                this._notifyReloadApplications();
            },

            /**
             * Resource page END
             */

            /**
             * Account page START
             */
            _onResourceActionPage: function() {
                this.getCurrentAppscoPageElement().toggleResource();
            },

            _onAccountAdvancedSettings: function() {
                this.getCurrentAppscoPageElement()._onAccountAdvancedSettings();
            },

            _onAccountSettingsSaved: function(event) {

                switch (this.page) {
                    case 'manage-account':
                        this._notify('Account settings for ' + event.detail.account.name + ' were successfully changed.');

                        break;

                    case 'account':
                    case 'company-account':
                        this._notify('Account settings were successfully changed.');

                        break;
                }

                this._notifyReloadAccounts();
            },

            _onAccountPasswordChanged: function() {
                this._notify('Account password was successfully changed.');

                this._notifyReloadAccounts();
            },

            _onRevokeAuthorizedApplication: function(event) {
                this._authorizedApplication = event.detail.application;
                this.$.appscoAccountAuthorizedAppRevoke.open();
            },

            _onAuthorizedApplicationRevoked: function(event) {
                var application = event.detail.application;

                this._authorizedApplication = {};
                this._notify(application.title + ' was successfully revoked.');
                this.getCurrentAppscoPageElement().reloadAuthorizedApplications();

                this._notifyAccountLog();
                this._notifyReloadAccounts();
            },

            _onEnableAccountAdvancedSettings: function() {
                var pageActions = this.getCurrentAppscoPageActionsElement();

                if (pageActions) {
                    pageActions.enableAdvancedSettings();
                }
            },

            _onDisableAccountAdvancedSettings: function() {
                var pageActions = this.getCurrentAppscoPageActionsElement();

                if (pageActions) {
                    pageActions.disableAdvancedSettings();
                }
            },

            _onTwoFaEnabled: function() {
                this._notify("Two-factor authentication enabled.");

                this._notifyReloadAccounts();
            },

            _onDisableTwoFaAction: function() {
                this.$.appscoAccountDisableTwoFa.open();
            },

            _setupAfterTwoFaDisabled: function() {

                if (this.$.appscoAccountPage.$) {
                    this.$.appscoAccountPage.setupAfterTwoFaDisabled();
                }

                if (this.$.appscoCompanyAccountPage.$) {
                    this.$.appscoCompanyAccountPage.setupAfterTwoFaDisabled();
                }
            },

            _onTwoFaDisabled: function() {
                this._notifyReloadAccounts();
                this._setupAfterTwoFaDisabled();
                this._notify('Two-factor authentication disabled successfully.');
            },

            _onReloadAccountLog: function() {
                if (this.$.appscoAccountPage.$) {
                    this.$.appscoAccountPage.reloadLog();
                }

                if (this.$.appscoCompanyAccountPage.$) {
                    this.$.appscoCompanyAccountPage.reloadLog();
                }
            },

            _onTokenGenerated: function() {
                this._notify('Transfer token was successfully generated.');
            },
            /**
             * Account page END
             */

            /**
             * Vault page START
             */
            _onLoadedVaultItems: function() {

                if (this.page === 'vault') {
                    this.$.appscoVaultPage.setDefaultItem();
                }

            },

            _onAddVaultAction: function(event) {
                var appscoVaultItemManage = this.$.appscoVaultItemManage;

                appscoVaultItemManage.open(event.detail.action);
            },

            _onEditVaultAction: function(event) {
                var appscoVaultItemManage = this.$.appscoVaultItemManage;

                appscoVaultItemManage.set('item', event.detail.item);
                appscoVaultItemManage.open(event.detail.item.vaultType);
            },

            _onRemoveVaultAction: function(event) {
                var appscoVaultItemRemove = this.$.appscoVaultItemRemove;

                appscoVaultItemRemove.item = event.detail.item;
                appscoVaultItemRemove.open();
            },

            _onItemSaved: function(event) {
                var item = event.detail.item,
                    appscoVaultPage = this.$.appscoVaultPage;

                appscoVaultPage.item = item;
                appscoVaultPage.setItem(item);
                this._notify('Vault item ' + item.displayTitle + ' has been successfully saved.');
            },

            _onVaultItemRemoved: function(event) {
                var appscoVaultPage = this.$.appscoVaultPage;

                appscoVaultPage.removeItem(event.detail.item);
                appscoVaultPage.hideInfo();
                appscoVaultPage.setDefaultItem();
                this._notify('Vault item ' + event.detail.item.displayTitle + ' removed.');

            },
            /**
             * Vault page END
             */

            /**
             * Upgrade page START
             */
            _onUpgradeTogglePricing: function() {
                this.$.appscoUpgradePage.togglePricing();
            },
            /**
             * Upgrade page END
             */

            /**
             * Resources page START
             */
            _filterCompanyApplicationsByTerm: function(term) {
                this._showProgressBar();
                this.$.appscoResourcesPage.filterResourcesByTerm(term);
            },

            _onSearchCompanyApplications: function(event) {
                this._filterCompanyApplicationsByTerm(event.detail.term);
            },

            _onSearchCompanyApplicationsClear: function() {
                this._filterCompanyApplicationsByTerm('');
            },

            _onResourceActionManageApplicationPage: function() {
                this.$.appscoManageApplicationPage.toggleResource();
            },

            _searchAssignees: function(term) {
                this._showProgressBar();
                this.$.appscoManageApplicationPage.searchAssignees(term);
            },

            _onSearchAssignees: function(event) {
                this._searchAssignees(event.detail.term);
            },

            _onSearchAssigneesClear: function() {
                this._searchAssignees('');
            },

            _onEditCompanyResource: function() {
                this._showManagePage('manage-resource/' + this._companyApplication.alias);
            },

            _onInfoEditCompanyResource: function() {
                this._onEditCompanyResource();
            },

            _refreshOrgunits: function(data) {
                var applicationsPage = this.$.appscoResourcesPage.$ ? this.$.appscoResourcesPage : null,
                    directoryPage = this.$.appscoDirectoryPage.$ ? this.$.appscoDirectoryPage : null;

                switch (data.event) {
                    case 'orgunit-added':

                        if (null != applicationsPage) {
                            applicationsPage.addOrgunit(data.orgunit);
                        }

                        if (null != directoryPage) {
                            directoryPage.addOrgunit(data.orgunit);
                        }

                        break;

                    case 'orgunit-modified':

                        if (null != applicationsPage) {
                            applicationsPage.modifyOrgunit(data.orgunit);
                        }

                        if (null != directoryPage) {
                            directoryPage.modifyOrgunit(data.orgunit);
                        }

                        break;

                    case 'orgunit-removed':

                        if (null != applicationsPage) {
                            applicationsPage.removeOrgunit(data.orgunit);
                        }

                        if (null != directoryPage) {
                            directoryPage.removeOrgunit(data.orgunit);
                        }

                        break;
                }

            },

            _onAddOrgunit: function(event) {
                var orgunitAddDialog = this.$.appscoOrgunitModify;

                orgunitAddDialog.parent = event.detail.orgUnit;
                orgunitAddDialog.orgUnit = {};
                orgunitAddDialog.open();
            },

            _onOrgunitAdded: function(event) {
                var orgunit = event.detail.orgUnit;

                this._refreshOrgunits({
                    page: this.page,
                    event: event.type,
                    orgunit: orgunit
                });

                this._notify('Organization unit ' + orgunit.name + ' successfully added.');

                this._notifyAccountLog();
            },

            _onModifyOrgunit: function(event) {
                var orgunitModifyDialog = this.$.appscoOrgunitModify;

                orgunitModifyDialog.parent = {};
                orgunitModifyDialog.orgUnit = event.detail.orgUnit;
                orgunitModifyDialog.open();
            },

            _onOrgunitModified: function(event) {
                var orgunit = event.detail.orgUnit;

                this._refreshOrgunits({
                    page: this.page,
                    event: event.type,
                    orgunit: orgunit
                });

                this._notify('Organization unit ' + orgunit.name + ' successfully modified.');

                this._notifyAccountLog();
            },

            _onRemoveOrgunit: function(event) {
                var orgunitRemoveDialog = this.$.appscoOrgunitRemove;

                orgunitRemoveDialog.orgUnit = event.detail.orgUnit;
                orgunitRemoveDialog.open();
            },

            _onOrgunitRemoved: function(event) {
                var orgunit = event.detail.orgUnit;

                this._refreshOrgunits({
                    page: this.page,
                    event: event.type,
                    orgunit: orgunit
                });

                this._notify('Organization unit ' + orgunit.name + ' successfully removed.');

                this._notifyAccountLog();
            },

            _onAddCompanyItemAction: function(event) {
                var action = event.detail.action,
                    applicationTemplate = event.detail.applicationTemplate;

                switch (action) {
                    case 'sso-application':
                        this.$.appscoCompanySSOApplicationsAdd.setAction(action);
                        this.$.appscoCompanySSOApplicationsAdd.toggle();
                        break;
                    case 'catalogue-application':
                        this.$.appscoCompanyApplicationsAdd.setAction(action);
                        this.$.appscoCompanyApplicationsAdd.toggle();
                        break;
                    default:
                        var request = document.createElement('iron-request'),
                            options = {
                                url: this.domain + applicationTemplate,
                                method: 'GET',
                                handleAs: 'json',
                                headers: {
                                    'Authorization': 'token ' + this.authorizationToken
                                }
                            };

                        request.send(options).then(function() {

                            if (200 == request.status) {
                                this.$.appscoDialogApplicationCompanyAdd.setApplicationTemplate(request.response.application);
                                this.$.appscoDialogApplicationCompanyAdd.setAction(action);
                                this.$.appscoDialogApplicationCompanyAdd.toggle();
                            }

                        }.bind(this));
                        break;
                }
            },

            _onCompanyApplicationAdded: function(event) {
                var application = event.detail.application,
                    message = application.title + ' was successfully saved.';

                this._notify(message);
            },

            _onCompanyApplicationClaimsUpdated: function (event) {
                var application = event.detail.application,
                        applications = [application];
                this.$.appscoResourcesPage.addResources(applications);
            },

            _onImportResourcesAction: function() {
                this.$.appscoImportResources.toggle();
            },

            _onImportCompanyResourcesFinished: function(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfCustomApplications + response.numberOfSecureNotes + ' resources imported out of '
                    + response.total + ', '
                    + response.numberOfCustomApplications + ' custom applications created, '
                    + response.numberOfSecureNotes + ' secure notes created, '
                    + 'number of failed imports ' + response.numberOfFailed + '.';

                if (0 < response.numberOfCustomApplications || 0 < response.numberOfSecureNotes) {
                    this._reloadCompanyApplications();
                }

                this._notify(message, true);
                this._notifyAccountLog();
            },

            _addApplicationsToOrgunit: function(applications) {

                if (applications.length > 0) {
                    this.set('_selectedApplications', applications);
                    this.$.appscoApplicationOrgunit.toggle();
                }
            },

            _onAddApplicationsToOrgunit: function() {
                var selectedApplications = this.$.appscoResourcesPage.getSelectedResources();

                this._addApplicationsToOrgunit(selectedApplications);
            },

            _onApplicationsAddedToOrgunit: function(event) {
                var applications = event.detail.applications,
                    orgunit = event.detail.orgunit,
                    application = applications[applications.length - 1];

                this._notify('Selected resources were successfully added to ' + orgunit.name + '.');
                this._modifyCompanyApplications(applications);
                this._reloadCompanyHomePageApplications();
                this._reloadHomePageApplications();
                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
                this._reloadApplicationAssignees();

                this.set('_companyApplication', {});
                this.set('_companyApplication', application);
            },

            _onShareApplications: function() {
                var selectedApplications = this.$.appscoResourcesPage.getSelectedResources();

                if (selectedApplications.length > 0) {
                    this.set('_applicationsToShare', selectedApplications);
                    this.$.appscoCompanyApplicationsShare.toggle();
                }
            },

            _onShareCompanyResource: function(event) {
                this.set('_applicationsToShare', []);
                this.set('_applicationsToShare', [event.detail.resource]);
                this.$.appscoCompanyApplicationsShare.toggle();
            },

            _onCompanyApplicationsShared: function(event) {
                var applications = event.detail.applications,
                    length = applications.length,
                    application = applications[length - 1];

                for (var i = 0; i < length; i++) {

                    if (this._companyApplication.self === applications[i].self) {
                        application = applications[i];
                        break;
                    }
                }

                this.set('_companyApplication', {});
                this.set('_companyApplication', application);

                this.resetApplicationAssigneesPage();

                this._notify('Selected resources were successfully shared.');

                this._notifyReloadApplications();
            },

            resetApplicationAssigneesPage: function() {

                if (this.$.appscoManageApplicationPageActions.$) {
                    this.$.appscoManageApplicationPageActions.resetApplicationAssigneesPageActions();
                }
            },

            _reloadApplicationAssignees: function() {

                if (this.$.appscoManageApplicationPage.$) {
                    this.$.appscoManageApplicationPage.reloadAssignees();
                }
            },

            _modifyCompanyApplications: function(applications) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.modifyResources(applications);
                }
            },

            _reloadCompanyHomePageApplications: function() {

                if (this.$.appscoCompanyHomePage.$) {
                    this.$.appscoCompanyHomePage.reloadApplications();
                }
            },

            _reloadContactHomePageApplications: function() {

                if (this.$.appscoContactHomePage.$) {
                    this.$.appscoContactHomePage.reloadApplications();
                }
            },

            _reloadCompanyApplications: function() {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.reloadResources();
                }
            },

            _onChangeAssigneeClaims: function(event) {
                var assigneeClaimsComponent = this.$.appscoApplicationAssigneeClaims;

                assigneeClaimsComponent.setApplication(event.detail.application);
                assigneeClaimsComponent.setAssignee(event.detail.assignee);
                assigneeClaimsComponent.toggle();
            },

            _onAssigneeClaimsChanged: function(event) {
                this._notifyReloadAccounts();
                this._onApplicationUpdated(event);
                this._notify('Claims for ' + event.detail.assignee.display_name + ' were successfully changed.');
            },

            _onRevokeAssigneeAccess: function(event) {
                var assigneeRevokeComponent = this.$.appscoApplicationAssigneeRevoke;

                assigneeRevokeComponent.setAssignee(event.detail.assignee);
                assigneeRevokeComponent.toggle();
            },

            _removeApplicationAssignee: function(application, assignee) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.removeResourceAssignee(application, assignee);
                }

                if (this.$.appscoManageApplicationPage.$) {
                    this.$.appscoManageApplicationPage.removeApplicationAssignee(application, assignee);
                }
            },

            _onAssigneeAccessRevoked: function(event) {
                var application = event.detail.application,
                    assignee = event.detail.assignee;

                this.resetApplicationAssigneesPage();
                this._removeApplicationAssignee(application, assignee);

                if (this.$.appscoManageAccountPage.$) {
                    this.$.appscoManageAccountPage.reloadApplications();
                }

                if (this.$.appscoManageContactPage.$) {
                    this.$.appscoManageContactPage.reloadApplications();
                }

                this._notifyReloadApplications();
                this._notifyReloadAccounts();
                this._notify('Access for ' + assignee.display_name + ' on ' + application.title + ' was revoked successfully.');
            },

            _removeApplications: function(applications) {

                if (applications.length > 0) {
                    this.set('_selectedApplications', applications);
                    this.$.appscoCompanyApplicationsRemove.toggle();
                }
            },

            _onRemoveApplications: function() {
                var selectedApplications = this.$.appscoResourcesPage.getSelectedResources();

                this._removeApplications(selectedApplications);
            },

            _onApplicationsRemoved: function(event) {
                this.set('_selectedApplications', []);

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.removeResources(event.detail.applications);
                }

                this._showCompanyResourcesPage();
                this._notify('Selected resources were successfully removed from company.');

                this._notifyReloadApplications();
            },

            _onApplicationsRemoveFailed: function() {
                this.set('_selectedApplications', []);
                this._notify('An error occurred. Selected resources were not removed from company. Please try again.');
            },

            _onRemoveCompanyApplication: function(event) {
                this._removeApplications([event.detail.application]);
            },

            _onAddApplicationToOrgunit: function(event) {
                this._addApplicationsToOrgunit([event.detail.application]);
            },

            _onRemoveApplicationFromOrgunit: function(event) {
                this.$.appscoApplicationRemoveOrgunit.orgunit = event.detail.orgunit;
                this._companyApplication = event.detail.application;
                this.$.appscoApplicationRemoveOrgunit.toggle();
            },

            _onRemoveApplicationFromGroup: function(event) {
                this.$.appscoApplicationRemoveGroup.setGroup(event.detail.group);
                this.$.appscoApplicationRemoveGroup.setApplication(event.detail.application);
                this.$.appscoApplicationRemoveGroup.toggle();
            },

            _onApplicationRemovedFromOrgunit: function(event) {
                var application = event.detail.application,
                    orgunit = event.detail.orgunit;

                this._modifyCompanyApplications([application]);
                this._reloadApplicationAssignees();

                this._companyApplication = application;
                this._notify(application.title + ' has been removed from ' + orgunit.name + ' organization unit.');

                this._notifyReloadApplications();
            },

            _onApplicationRemovedFromGroup: function(event) {
                var application = event.detail.application,
                        group = event.detail.group;

                this.$.appscoManageApplicationPage.removeGroup(group);
                this.$.appscoManageApplicationPage.reload();

                this._notify(application.application.title + ' has been successfully removed from group ' + group.name + '.');
                this._notifyReloadApplications();
            },

            _onEnableAssigneesSearchAction: function() {
                this.$.appscoManageApplicationPageActions.enableAssigneesSearchAction();
            },

            _onDisableAssigneesSearchAction: function() {
                this.$.appscoManageApplicationPageActions.disableAssigneesSearchAction();
            },
            /**
             * Resources page END
             */

            /**
             * Directory page START
             */
            _onInvitationResent: function(event) {
                this._notify('Invitation for account ' + event.detail.invitation.email + ' has been sent.');
            },

            _onContactInvitationResent: function(event) {
                this._notify('Invitation for contact ' + event.detail.invitation.email + ' has been sent.');
            },

            _onRemoveInvitationAction: function(event) {
                var invitationDeleteComponent = this.$.appscoInvitationRemove;

                invitationDeleteComponent.setInvitation(event.detail.invitation);
                invitationDeleteComponent.open();
            },

            _onInvitationRemoved: function(event) {
                var invitation = event.detail.invitation;

                switch (invitation.type) {
                    case 'user':
                        this.$.appscoDirectoryPage.removeInvitations([invitation]);
                        break;

                    case 'contact':
                        this.$.appscoContactsPage.removeInvitations([invitation]);
                        break;

                    default:
                        return false;
                }

                this._notify('Invitation for account ' + invitation.email + ' has been removed.');

            },

            _onInvitationAlreadyRemoved: function(event) {
                var invitation = event.detail.invitation;

                this.$.appscoDirectoryPage.removeInvitations([invitation]);
                this._notify('Invitation for account ' + invitation.email + ' has already been removed.');
            },

            _evaluateSubscriptionLicences: function() {

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.evaluateSubscriptionLicences();
                }
            },

            _searchAccounts: function(term) {
                this._showProgressBar();
                this.$.appscoDirectoryPage.filterDirectoryResourcesByTerm(term);
            },

            _onSearchAccounts: function(event) {
                this._searchAccounts(event.detail.term);
            },

            _onSearchAccountsClear: function() {
                this._searchAccounts('');
            },

            _onCompanyAddAccount: function() {
                this.$.appscoDirectoryAccountAdd.toggle();
            },

            _onCompanyImportAccounts: function() {
                this.$.appscoDirectoryImportAccounts.toggle();
            },

            _onInvitationCreated: function(event) {
                var invitation = event.detail.invitation;

                switch (invitation.type) {
                    case 'user':
                        this.$.appscoDirectoryPage.addInvitations([invitation]);
                        break;

                    case 'contact':
                        this.$.appscoContactsPage.addInvitations([invitation]);
                        break;

                    default:
                        return false;
                }

                this._notify('Invitation for account ' + invitation.email + ' was successfully created.');
            },

            _onCompanyRoleCreated: function(event) {
                this.$.appscoDirectoryPage.addAccounts([event.detail.role]);
                this._reloadProvisioningIntegrationAccounts();
                this._notify('Account ' + event.detail.role.account.email + ' was successfully added.');
            },

            _onCustomerResourcesImportFinished: function(event) {
                var response = event.detail.response,
                        message;
                message = 'Customer resources imported. Number of failed imports: ' + response.numberOfFailed;
                this._notify(message, true);
                this._notifyAccountLog();
            },

            _onAccountImportFinished: function(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfRoles + ' accounts imported out of ' + response.total + '.'
                        + ' Number of invitations created: ' + response.numberOfInvitations + '.'
                        + ' Number of failed imports: ' + response.numberOfFailed + '.';

                if (0 < response.numberOfRoles) {
                    this._reloadCompanyAccounts();
                    this._reloadProvisioningIntegrationAccounts();
                }

                if (0 < response.numberOfInvitations) {
                    this._reloadCompanyInvitations();
                }

                if (response.maxSubscriptionSizeReached) {
                    this._showSubscriptionLimitReachedInfo(this._subscription);
                }

                this._notify(message, true);
                this._notifyAccountLog();
            },

            _addAccountsToOrgunit: function(accounts) {

                if (accounts.length > 0) {
                    this.set('_selectedAccounts', accounts);
                    this.$.appscoAccountOrgunit.toggle();
                }
                else {
                    this._onHideDirectoryBulkActions()
                }
            },

            _onAddAccountsToOrgunit: function() {
                var selectedAccounts = this.$.appscoDirectoryPage.getSelectedAccounts();

                this._addAccountsToOrgunit(selectedAccounts);
            },

            _onAccountsAddedToOrgunit: function(event) {
                var accounts = event.detail.accounts,
                    length = accounts.length;

                this._notify('Selected accounts were successfully added to ' + event.detail.orgunit.name + '.');

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.modifyAccounts(accounts);
                }

                if (accounts.length === 1) {
                    this._role = accounts[0];
                }

                for (var i = 0; i < length; i++) {
                    if (accounts[i].account.email === this.account.email) {
                        this._reloadHomePageApplications();
                        break;
                    }
                }

                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
            },

            _onRemoveAccounts: function() {
                var selectedAccounts = this.$.appscoDirectoryPage.getSelectedAccounts();

                if (selectedAccounts.length > 0) {
                    this.set('_selectedAccounts', selectedAccounts);
                    this.$.appscoAccountsRemove.toggle();
                }
                else {
                    this._onHideDirectoryBulkActions()
                }
            },

            _onAccountsRemoved: function(event) {
                this.$.appscoDirectoryPage.removeAccounts(event.detail.accounts);
                this._onHideDirectoryBulkActions();
                this.set('_selectedAccounts', []);
                this._reloadProvisioningIntegrationAccounts();
                this._notify('Selected accounts were successfully removed from company.');

                this._notifyAccountLog();
            },

            _onManageDomains: function() {
                this.$.appscoCompanyPage.showDomainsPage = true;
                this._showCompanyPage();
            },

            _onFilterRoles: function(event) {
                var filter = event.detail.filter;

                this._showProgressBar();
                this.$.appscoDirectoryPage.filterAccounts(filter);
            },

            _reloadCompanyAccounts: function() {
                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.reloadAccounts();
                }
            },

            _reloadCompanyContacts: function() {
                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.reloadContacts();
                }
            },

            _reloadCompanyInvitations: function() {
                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.reloadInvitations();
                }
            },

            _onReloadAccounts: function() {

                switch (this.page) {
                    case 'manage-account':
                        this._reloadCompanyAccounts();
                        break;

                    default:
                        break;
                }
            },

            _showSubscriptionLimitReachedInfo: function(subscription) {

                this.fire('show-subscription-limit-reached-info', {
                    subscription: subscription
                });
            },

            _onResetDirectoryTypeFilter: function() {
                this.$.appscoDirectoryPageActions.resetTypeFilter();
            },
            /**
             * Directory page END
             */

            /**
             * Manage Account page START
             */
            _onShowSubscriptionLimitReachedInfo: function(event) {
                this.$.appscoDirectoryPageActions.showSubscriptionLimitReachedInfo(event.detail.subscription);
            },

            _onHideSubscriptionLimitReachedInfo: function() {
                this.$.appscoDirectoryPageActions.hideSubscriptionLimitReachedInfo();
            },

            _onShowDomainNotVerifiedInfo: function() {
                this.$.appscoDirectoryPageActions.showDomainNotVerifiedInfo();
            },

            _onHideDomainNotVerifiedInfo: function() {
                this.$.appscoDirectoryPageActions.hideDomainNotVerifiedInfo();
            },

            _onEditAccount: function(event) {
                var role = event.detail.role;

                this.set('_role', role);
                this._showManagePage('manage-account/' + role.alias);
            },

            _onResourceActionManageAccountPage: function() {
                this.$.appscoManageAccountPage.toggleResource();
            },

            _onCompanyAccountPasswordChanged: function(event) {
                this._notify('Password for ' + event.detail.account.name + ' was successfully changed.');

                this._notifyReloadAccounts();
            },

            _onAddAccountToOrgunit: function(event) {
                this._addAccountsToOrgunit([event.detail.role]);
            },

            _onRemoveAccountFromOrgunit: function(event) {
                this.$.appscoAccountRemoveOrgunit.orgunit = event.detail.orgunit;
                this._role = event.detail.account;
                this.$.appscoAccountRemoveOrgunit.toggle();
            },

            _onRemoveAccountFromGroup: function(event) {
                this.$.appscoAccountRemoveGroup.group = event.detail.group;
                this._role = event.detail.account;
                this.$.appscoAccountRemoveGroup.toggle();
            },

            _onRemoveContactFromGroup: function(event) {
                this.$.appscoContactRemoveGroup.setGroup(event.detail.group);
                this.$.appscoContactRemoveGroup.setContact(event.detail.contact);
                this.$.appscoContactRemoveGroup.toggle();
            },

            _onAccountRemovedFromOrgunit: function(event) {
                var role = event.detail.account;

                if (role.account.email === this.account.email) {
                    this._reloadHomePageApplications();
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.modifyAccounts([role]);
                }

                this._role = role;
                this._notify(role.account.name + ' has been removed from ' + event.detail.orgunit.name + ' organization unit.');

                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
            },

            _onAccountRemovedFromGroup: function(event) {
                var role = event.detail.account,
                    group = event.detail.group;

                this.$.appscoManageAccountPage.removeGroup(group);

                if (role.account.email === this.account.email) {
                    this._reloadHomePageApplications();
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.modifyAccounts([role]);
                }

                this._role = role;
                this._notify(role.account.name + ' has been successfully removed from group ' + group.name + '.');

                this._notifyAccountLog();
                this._notifyReloadApplications();
                this._notifyReloadAccounts();
            },

            _onContactRemovedFromGroup: function(event) {
                var contact = event.detail.contact,
                        group = event.detail.group;

                this.$.appscoManageContactPage.removeGroup(group);
                this.$.appscoManageContactPage.reload();

                this.$.appscoContactsPage.reloadContacts();

                this._notify(contact.display_name + ' has been successfully removed from group ' + group.name + '.');
            },

            _onAccountRoleChanged: function(event) {
                var accountName = event.detail.account.account.name,
                    role = event.detail.role,
                    message = '';

                if (role.value) {
                    message = role.name + ' role is given to ' + accountName + '.';
                }
                else {
                    message = role.name + ' role is revoked from ' + accountName + '.';
                }

                this._notify(message);

                this._notifyReloadAccounts();
            },
            /**
             * Manage Account page END
             */

            /**
             * Contacts page START
             */
            _onAddContactAction: function() {
                this.$.appscoAddContact.toggle();
            },

            _onContactCreated: function(event) {
                var contact = event.detail.contact;

                this.$.appscoContactsPage.addContacts([contact]);
                this._notify('Contact ' + contact.email + ' was successfully added.');
            },

            _onImportContactsAction: function() {
                this.$.appscoImportContacts.toggle();
            },

            _onImportContactsFinished: function(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfContacts + ' contacts imported out of ' + response.total + '.'
                    + ' Number of invitations created: ' + response.numberOfInvitations + '.'
                    + ' Number of failed imports: ' + response.numberOfFailed + '.';

                if (0 < response.numberOfContacts) {
                    this._reloadContactsAndActions();
                }

                if (0 < response.numberOfInvitations) {
                    this._reloadContactsInvitations();
                }

                this._notify(message, true);
                this._notifyAccountLog();
            },

            _reloadContactsAndActions: function() {

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.reloadContactsAndActions();
                }
            },

            _reloadContactsInvitations: function() {
                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.reloadInvitations();
                }
            },

            _onDeleteContactsAction: function() {
                var selectedContacts = this.$.appscoContactsPage.getSelectedContacts();

                if (selectedContacts.length > 0) {
                    this.set('_selectedContacts', selectedContacts);
                    this.$.appscoContactsRemove.toggle();
                }
                else {
                    this._onHideContactBulkActions()
                }
            },

            _onDeletedContacts: function() {
                this.$.appscoContactsPage.removeContacts(this._selectedContacts);
                this.$.appscoContactsPage.hideBulkActions();
                this._notify('Selected contacts were successfully removed from company.');
            },

            _onDeleteContactsFailed: function() {
                this.set('_selectedContacts', []);
                this._notify('An error occurred. Selected contacts were not removed from company. Please try again.');
            },

            _onAddGroupsToContactsAction: function() {
                var selectedContacts = this.$.appscoContactsPage.getSelectedContacts();
                this._shareToGroup(selectedContacts, 'contact');
            },

            _onSelectAllContactsAction: function() {
                this.$.appscoContactsPage.selectAllContacts();
            },

            _onContactsPageSelected: function(event) {
                var page = event.detail.page.toLowerCase();

                this.$.appscoContactsPage.showPage(page);
            },

            _searchContacts: function(term) {
                this._showProgressBar();
                this.$.appscoContactsPage.filterByTerm(term);
            },

            _onSearchContacts: function(event) {
                this._searchContacts(event.detail.term);
            },

            _onSearchContactsClear: function() {
                this._searchContacts('');
            },
            /**
             * Contacts page END
             */

            /**
             * Groups page START
             */
            _onAddCompanyGroupAction: function() {
                this.$.appscoCompanyAddGroup.open();
            },

            _onSearchCompanyGroupAction: function(event) {
                this._searchCompanyGroups(event.detail.term);
            },

            _onSearchCompanyGroupClear: function() {
                this._searchCompanyGroups('');
            },

            _searchCompanyGroups: function(term) {
                this._showProgressBar();
                this.$.appscoGroupsPage.filterByTerm(term);
            },

            _onEditCompanyGroupAction: function(event) {
                var group = event.detail.item;

                this.set('_group', group);
                this._showManagePage('manage-group/' + group.alias);
            },
            /**
             * Groups page END
             */


            /**
             * Manage Contact page START
             */
            _onEditContactAction: function(event) {
                var contact = event.detail.contact;

                if (this.$.appscoManageContactPage.$) {
                    this.$.appscoManageContactPage.setContact(contact);
                }

                this._showManagePage('manage-contact/' + contact.alias);
            },

            _onHideContactsBulkActions: function() {
                this.$.appscoContactsPageActions.hideBulkActions();
            },

            _onConvertContactToUserAction: function(event) {
                var contact = event.detail.contact,
                    convertContact = this.$.appscoConvertContact;

                convertContact.setContact(contact);
                convertContact.toggle();
            },

            _onContactConverted: function(event) {
                var contact = event.detail.contact;

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.removeContacts([contact]);
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.reloadAccounts();
                }

                this._showContactsPage();
                this._notify('Contact ' + contact.display_name + ' has been successfully converted to company user.');
            },

            _onDeleteContactAction: function(event) {
                var contact = event.detail.contact,
                    deleteContact = this.$.appscoDeleteContact;

                deleteContact.setContact(contact);
                deleteContact.toggle();
            },

            _onDeleteCustomerAction: function(event) {
                this.$.appscoRemoveCustomer.setCustomer(event.detail.customer);
                this.$.appscoRemoveCustomer.open();
            },

            _onCustomerRemoved: function(event) {
                var customer = event.detail.customer;

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.removeCustomers([customer]);
                }

                this._showCustomersPage();
                this._notify('Customer ' + customer.name + ' has been deleted from company.');
            },

            _onContactDeleted: function(event) {
                var contact = event.detail.contact;

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.removeContacts([contact]);
                }

                this._showContactsPage();
                this._notify('Contact ' + contact.display_name + ' has been deleted from company.');
            },
            /**
             * Manage Contact page END
             */

            /**
             * Audit Log page START
             */
            _onResourceActionAuditLogPage: function() {
                this.$.appscoAuditLogPage.toggleResource();
            },
            /**
             * Audit Log page END
             */

            /**
             * Billing page START
             */
            _onResourceActionBillingPage: function() {
                this.$.appscoBillingPage.toggleResource();
            },

            _fireUpgrade: function() {
                this.$.appscoUpgradeAction.toggle();
            },

            _setSubscription: function(subscription) {

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.setSubscription(subscription);
                }
                else {
                    this.$.appscoDirectoryPage.subscription = subscription;
                    this.$.appscoDirectoryPage.subscriptionLoaded = true;
                }
            },

            _reloadSubscription: function() {

                if (this.$.appscoBillingPage.$) {
                    this.$.appscoBillingPage.reloadSubscription();
                }
            },

            _onSubscriptionChanged: function(event) {
                this._setSubscription(event.detail.subscription);
                this._reloadSubscription(event.detail.subscription);
                this._reloadProvisioningIntegrationAccounts();
                this._evaluateSubscriptionLicences();
                this._notify('Subscription has been successfully changed.');
            },

            _onCancelSubscription: function() {
                this.$.appscoSubscriptionCancel.toggle();
            },

            _onSubscriptionCanceled: function(event) {
                this._setSubscription(event.detail.subscription);
                this._reloadSubscription();
                this._notify('Subscription has been successfully canceled.');
            },

            _onManageCreditCard: function() {
                this.$.appscoCreditCard.toggle();
            },

            _onCreditCardAdded: function(event) {
                this.$.appscoBillingPage.setCreditCard(event.detail.credit_card);
                this._notify('Credit card has been successfully saved.');
            },

            _onSendInvoice: function(event) {
                this.$.appscoBillingSendInvoice.setInvoice(event.detail.invoice);
                this.$.appscoBillingSendInvoice.toggle();
            },

            _onInvoiceSent: function(event) {
                this._notify('Invoice has been sent to ' + event.detail.sentTo + '.');
            },
            /**
             * Billing page END
             */

            /**
             * Provisioning page START
             */
            _onStartAuthorization: function(event) {
                this.$.appscoStartIntegration.setIntegration(event.detail.integration);
                this.$.appscoStartIntegration.toggle();
            },

            _onIntegrationSetup: function(event) {
                this._selectedIntegration = event.detail.integration;
                this.set('routeData.page', 'provisioning-settings');
            },

            _onResourceActionProvisioningSettingsPage: function() {
                this.$.appscoProvisioningSettingsPage.toggleResource();
            },

            _onLocalAccountSynced: function(event) {
                this._reloadCompanyAccounts();
                this._notify('Remote account ' + event.detail.item.remoteAccount.display_name + ' was successfully synced with ' + event.detail.item.localAccount.account.display_name + ' AppsCo account.');
            },

            _onNewAccountSynced: function(event) {
                this._reloadCompanyAccounts();
                this._notify('Remote account ' + event.detail.item.remoteAccount.display_name + ' was successfully imported.');
            },

            _onAccountsSyncFinished: function(event) {
                this._reloadCompanyAccounts();
                this._notify('Selected accounts were successfully synced.');
            },

            _onSyncAccounts: function() {
                this.$.appscoProvisioningSettingsPage.syncAccounts();
            },

            _onRefreshAccounts: function() {
                this.$.appscoProvisioningSettingsPage.refreshAccounts();
            },

            _reloadProvisioningIntegrationAccounts: function() {

                if (this.$.appscoProvisioningSettingsPage.$) {
                    this.$.appscoProvisioningSettingsPage.reloadAccounts();
                }
            },

            _onSyncedAccountRemoved: function(event) {
                this._notify('Synced account ' + event.detail.item.remoteAccount.display_name + ' was successfully removed.');
            },

            _onInitializeProvisioningPage: function() {
                this.$.appscoProvisioningSettingsPageActions.initializePage();
            },

            _onResetProvisioningPage: function() {
                this.$.appscoProvisioningSettingsPageActions.resetPage();
            },

            _onShowBulkActionsProvisioningPage: function() {
                this.$.appscoProvisioningSettingsPageActions.showBulkActions();
            },

            _onHideBulkActionsProvisioningPage: function() {
                this.$.appscoProvisioningSettingsPageActions.hideBulkActions();
            },
            /**
             * Provisioning page END
             */

            /**
             * Company page START
             */
            _onResourceActionCompanyPage: function() {
                this.getCurrentAppscoPageElement().toggleResource();
            },

            _onCompanySettingsChanged: function(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company settings were successfully saved.');
            },

            _onCompanyBrandSettingsChanged: function(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company brand settings were successfully saved.');
            },

            _onCompanyLogoChanged: function(event) {
                this._setAccountCompany(event.detail.company);
                this._notify('Company logo was successfully saved.');

                this._notifyAccountLog();
            },

            _upgradedToBusiness: function(e) {
                this.account = {};
                this.account = e.detail.account;

                this.currentCompany = this.account.companies[this.account.companies.length - 1];
                this._setProduct(true);

                this.set('routeData.page', 'company');
                this._notify('Upgrade to AppsCo business succeeded.');

                setTimeout(function() {
                    this._notify('Please setup your company settings.');
                }.bind(this), 2000);
            },

            _onUpgradeToCompanyFailed: function(event) {
                this._notify(this._apiErrors.getError(event.detail.error), true);
            },

            _onShowDomainsPageActions: function() {
                this.$.appscoCompanyPageActions.showDomainsPageActions();
            },

            _onHideDomainsPageActions: function() {
                this.$.appscoCompanyPageActions.hideDomainsPageActions();
            },

            _onAddDomain: function() {
                this.$.appscoCompanyAddDomain.open();
            },

            _onDomainAdded: function(event) {
                var domain = event.detail.domain;

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.evaluateDomainVerification({
                        domain: domain,
                        added: true,
                        removed: false
                    });
                }

                this.$.appscoCompanyPage.addDomain(domain);
                this._notify('Domain ' + domain.domain + ' was successfully saved.');
            },

            _onRemoveDomain: function(event) {
                this.$.appscoCompanyRemoveDomain.setDomain(event.detail.domain);
                this.$.appscoCompanyRemoveDomain.open();
            },

            _onDomainRemoved: function(event) {
                var domain = event.detail.domain;

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.evaluateDomainVerification({
                        domain: domain,
                        added: false,
                        removed: true
                    });
                }

                this.$.appscoCompanyPage.removeDomain(domain);
                this._notify('Domain ' + domain.domain + ' was successfully removed.');
            },

            _onDomainGetToken: function(event) {
                this.$.appscoCompanyDomainToken.setDomain(event.detail.domain);
                this.$.appscoCompanyDomainToken.open();
            },

            _onDomainVerified: function(event) {
                var domain = event.detail.domain;

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.hideDomainNotVerifiedInfo();
                }

                if (this.$.appscoCompanyPage.$) {
                    this.$.appscoCompanyPage.reloadIdPDomains();
                }

                this.$.appscoCompanyPage.modifyDomain(domain);
                this._notify('Domain ' + domain.domain + ' was successfully verified.');
            },

            _onDomainNotVerified: function(event) {
                var domain = event.detail.domain;

                this._notify('Unable to verify ' + domain.domain + ' domain - please wait until the DNS record change is propagated.', true);
            },

            _onIdPSettingsSaved: function(event) {
                this._notify('IdP settings for ' + event.detail.domain.domain + ' domain was successfully saved.');
            },

            _onDeactivateDomainIdPSettings: function(event) {
                this.$.appscoDeactivateIdPSettings.setDomain(event.detail.domain);
                this.$.appscoDeactivateIdPSettings.open();
            },

            _onIdPSettingsDeactivated: function(event) {
                var domain = event.detail.domain;

                this.$.appscoCompanyPage.modifyDomain(domain);
                this._notify('IdP settings for ' + domain.domain + ' domain was successfully deactivated.');
            },
            /**
             * Company page END
             */

            /**
             * Groups page START
             */
            _onShowGroupsPageActions: function() {
                this.$.appscoCompanyPageActions.showGroupsPageActions();
            },

            _onHideGroupsPageActions: function() {
                this.$.appscoCompanyPageActions.hideGroupsPageActions();
            },

            _addGroup: function(group) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.addGroup(group);
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.addGroup(group);
                }

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.addGroup(group);
                }

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.addGroup(group);
                }
            },

            _onGroupAdded: function(event) {
                var group = event.detail.group;

                this._addGroup(group);
                this._notify('Group ' + group.name + ' was successfully saved.');
            },

            _searchGroups: function(term) {
                this._showProgressBar();
                this.$.appscoCompanyPage.searchGroups(term);
            },

            _onSearchGroups: function(event) {
                this._searchGroups(event.detail.term);
            },

            _onSearchGroupsClear: function() {
                this._searchGroups('');
            },

            _onRemoveGroupAction: function(event) {
                this.$.appscoCompanyRemoveGroup.setGroup(event.detail.group);
                this.$.appscoCompanyRemoveGroup.open();
            },

            _onGroupRemoved: function(event) {
                var group = event.detail.group;

                this._removeGroup(group);
                this._reloadApplicationsForCompanyAdministrator();
                this._showGroupsPage();
                this._notify('Group ' + group.name + ' was successfully removed.');
            },

            _removeGroup: function(group) {

                if (this.$.appscoResourcesPage.$) {
                    this.$.appscoResourcesPage.removeGroup(group);
                }

                if (this.$.appscoDirectoryPage.$) {
                    this.$.appscoDirectoryPage.removeGroup(group);
                }

                if (this.$.appscoContactsPage.$) {
                    this.$.appscoContactsPage.removeGroup(group);
                }

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.removeGroup(group);
                }

                this._reloadCompanyApplications();
                this._reloadCompanyAccounts();
                this._reloadCompanyContacts();
            },

            _shareToGroup: function(items, type) {

                if (items.length > 0) {
                    this.$.appscoShareToGroupDialog.setItems(items);
                    this.$.appscoShareToGroupDialog.setType(type);
                    this.$.appscoShareToGroupDialog.open();
                }
            },

            _onShareResourcesToGroup: function() {
                var selectedResources = this.$.appscoResourcesPage.getSelectedResources();

                this._shareToGroup(selectedResources, 'resource');
            },

            _onAddGroupsToCompanyRoles: function() {
                var selectedRoles = this.$.appscoDirectoryPage.getSelectedAccounts();

                this._shareToGroup(selectedRoles, 'account');
            },

            _handleResourcesAddedToGroupResponse: function(groups, items, resourceType) {
                var length = items.length,
                    oneItem = (length === 1);

                if (this.$.appscoManageGroupPage.$) {
                    this.$.appscoManageGroupPage.addGroupItems(groups, items, resourceType);
                }

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.recalculateTotals(groups, resourceType);
                }

                switch (resourceType) {
                    case 'resource':

                        if (oneItem) {
                            this._companyApplication = items[0];
                        }

                        this._notify('Selected resources were successfully shared to groups.');
                        this._modifyCompanyApplications(items);
                        this._reloadCompanyHomePageApplications();
                        this._reloadHomePageApplications();
                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'account':

                        if (oneItem) {
                            this._role = items[0];
                        }

                        if (this.$.appscoDirectoryPage.$) {
                            this.$.appscoDirectoryPage.modifyAccounts(items);
                        }

                        for (var i = 0; i < length; i++) {
                            if (items[i].account.email === this.account.email) {
                                this._reloadHomePageApplications();
                                this._reloadCompanyHomePageApplications();
                                this._reloadContactHomePageApplications();
                                break;
                            }
                        }

                        this._notify('Selected users were successfully added to groups.');
                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'contact':

                        this._notify('Selected contacts were successfully added to groups.');

                        if (this.$.appscoContactsPage.$) {
                            this.$.appscoContactsPage.modifyContacts(items);
                        }

                        break;

                    default:
                        return false;
                }
            },

            _onGroupsAddedToResources: function(event) {
                this._handleResourcesAddedToGroupResponse(event.detail.groups, event.detail.items, event.detail.resourceType);
            },

            _onAddItemToGroupAction: function(event) {
                var addToGroupComponent = this.$.appscoGroupAddResource,
                    action = event.detail.action;

                addToGroupComponent.setType(action);

                switch (action) {
                    case 'resource':
                        addToGroupComponent.setListItemsApi(this._companyApplicationsApi);
                        break;

                    case 'account':
                        addToGroupComponent.setListItemsApi(this._companyRolesApi);
                        break;

                    case 'contact':
                        addToGroupComponent.setListItemsApi(this._companyContactsApi);
                        break;

                    default:
                        return false;
                }

                addToGroupComponent.open();
            },

            _onResourcesAddedToGroup: function(event) {
                this._handleResourcesAddedToGroupResponse([event.detail.group], event.detail.items, event.detail.resourceType);
            },

            _removeResourceFromGroup: function(group, item, type) {
                this.$.appscoResourceRemoveFromGroup.setGroup(group);
                this.$.appscoResourceRemoveFromGroup.setItem(item);
                this.$.appscoResourceRemoveFromGroup.setType(type);
                this.$.appscoResourceRemoveFromGroup.open();
            },

            _removePartnerAdminFromCustomer: function(customer, partnerAdmin) {
                this.$.appscoCustomerPartnerAdminRemove.setCustomer(customer);
                this.$.appscoCustomerPartnerAdminRemove.setPartnerAdminRole(partnerAdmin);
                this.$.appscoCustomerPartnerAdminRemove.open();

            },

            _onRemoveCompanyRoleFromGroup: function(event) {
                this._removeResourceFromGroup(event.detail.group, event.detail.role, 'account');
            },

            _onRemoveCompanyContactFromGroup: function(event) {
                this._removeResourceFromGroup(event.detail.group, event.detail.contact, 'contact');
            },

            _onRemoveCompanyResourceFromGroup: function(event) {
                this._removeResourceFromGroup(event.detail.group, event.detail.resource, 'resource');
            },

            _onRemovePartnerAdminFromCustomer: function(event) {
                this._removePartnerAdminFromCustomer(event.detail.customer, event.detail.partnerAdmin);
            },

            _onPartnerAdminRemovedFromCustomer: function(event) {
                var partnerAdmin = event.detail.partnerAdmin,
                    customer = event.detail.customer;

                if (this.$.appscoManageCustomerPage.$) {
                    this.$.appscoManageCustomerPage.removePartnerAdmins(customer, [partnerAdmin]);
                }

                this._notify('Partner admin role revoked');
            },

            _onResourceRemovedFromGroup: function(event) {
                var item = event.detail.item,
                    group = event.detail.group,
                    resourceType = event.detail.resourceType;

                if (this.$.appscoGroupsPage.$) {
                    this.$.appscoGroupsPage.removeGroupItems(group, [item], resourceType);
                }

                if (this.$.appscoManageGroupPage.$) {
                    this.$.appscoManageGroupPage.removeGroupItems(group, [item], resourceType);
                }

                switch (resourceType) {
                    case 'resource':

                        this._notify(item.title + ' was successfully removed from ' + group.name + ' group.');

                        this._modifyCompanyApplications([item]);
                        this._reloadCompanyHomePageApplications();
                        this._reloadHomePageApplications();
                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'account':

                        this._notify(item.account.display_name + ' was successfully removed from ' + group.name + ' group.');

                        if (this.$.appscoDirectoryPage.$) {
                            this.$.appscoDirectoryPage.modifyAccounts([item]);
                        }

                        for (var i = 0; i < length; i++) {
                            if (item.account.email === this.account.email) {
                                this._reloadHomePageApplications();
                                this._reloadCompanyHomePageApplications();
                                break;
                            }
                        }

                        this._notifyAccountLog();
                        this._notifyReloadApplications();
                        this._notifyReloadAccounts();

                        break;

                    case 'contact':

                        this._notify(item.account.display_name + ' was successfully removed from ' + group.name + ' group.');

                        if (this.$.appscoContactsPage.$) {
                            this.$.appscoContactsPage.modifyContacts([item]);
                            this.$.appscoContactsPage.removeSelectedContacts([item]);
                        }

                        break;

                    default:
                        return false;
                }
            },
            /**
             * Groups page END
             */

            /**
             * Customers page START
             */
            _onEditCustomerAction: function(event) {
                var customer = event.detail.customer;
                if (this.$.appscoManageCustomerPage.$) {
                    this.$.appscoManageCustomerPage.setCustomer(customer);
                }

                this._showManagePage('manage-customer/' + customer.alias);
            },

            _onHideCustomersBulkActions: function() {
                this.$.appscoCustomersPageActions.hideBulkActions();
            },

            _searchCustomers: function(term) {
                this._showProgressBar();
                this.$.appscoCustomersPage.filterByTerm(term);
            },

            _onSearchCustomersAction: function(event) {
                this._searchCustomers(event.detail.term);
            },

            _onSearchCustomersClearAction: function() {
                this._searchCustomers('');
            },

            _onImportCustomerResources: function() {
                this.$.appscoImportCustomerResources.toggle();
            },

            _onAddCustomerAction: function() {
                this.$.appscoAddCustomer.open();
            },

            _onExportCustomersAction: function() {
                this.$.appscoCustomersPage.exportToCsv();
            },

            _onAddPartnerAdminAction: function(event) {
                var customer = event.detail.customer;
                this.set('_selectedCustomers', [customer]);
                this.$.appscoAddPartnerAdmin.setStopOnNextFail(true);
                this.$.appscoAddPartnerAdmin.open();
            },

            _addCustomer: function(customer) {

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.addCustomer(customer);
                }
            },

            _addPartnerAdmin: function(customer, partnerAdmin) {
                this.$.appscoManageCustomerPage.addPartnerAdmins(customer, [partnerAdmin]);
            },

            _reloadCustomers: function() {

                if (this.$.appscoCustomersPage.$) {
                    this.$.appscoCustomersPage.reloadCustomers();
                }
            },

            _removeCompaniesFromSwitcher: function(companies) {
                this.$.appscoHeader.removeProductCompanies(companies);
            },

            _onCustomerAdded: function(event) {
                var customer = event.detail.customer;

                this._addCustomer(customer);
                this._reloadCustomers();
                this._getLoggedAccount();
                this._notify('New customer ' + customer.name + ' was successfully added.');
            },

            _onRemoveCustomersAction: function() {
                var selectedCustomers = this.$.appscoCustomersPage.getSelectedCustomers();

                if (selectedCustomers.length > 0) {
                    this.set('_selectedCustomers', selectedCustomers);
                    this.$.appscoCustomersRemove.toggle();
                }
                else {
                    this._onHideCustomersBulkActions();
                }
            },

            _onRemovedCustomers: function(event) {
                var customersCount = this.$.appscoCustomersPage.removeCustomers(this._selectedCustomers);

                this._removeCompaniesFromSwitcher(event.detail.customers);
                this._onHideCustomersBulkActions();
                this._notify(customersCount + ' customers were successfully removed from company.');
            },

            _onRemoveCustomersFailed: function() {
                this.set('_selectedCustomers', []);
                this._notify('An error occurred. Selected customers were not removed from company. Please try again.');
            },

            _onAddPartnerAdminToCustomersAction: function() {
                var selectedCustomers = this.$.appscoCustomersPage.getSelectedCustomers();

                if (selectedCustomers.length > 0) {
                    this.set('_selectedCustomers', selectedCustomers);
                    this.$.appscoAddPartnerAdmin.open();
                }
                else {
                    this._onHideCustomersBulkActions();
                }
            },

            _onPartnerAdminAdded: function(event) {
                var partnerAdmin = event.detail.partnerAdmin,
                    customer = event.detail.customer;

                this._addPartnerAdmin(customer, partnerAdmin);
                this._notify('Partner admin added successfully.');
            },

            _onImportCustomersAction: function() {
                this.$.appscoImportCustomers.open();
            },

            _onCustomersImportFinished: function(event) {
                var response = event.detail.response,
                    message;

                message = response.numberOfCreated + ' customers created out of ' + response.total + '.'
                    + ' Number of failed imports: ' + response.numberOfFailed + '.'
                    + ' Number of existing companies: ' + response.numberOfExisting + '.';

                if (0 < response.numberOfCreated) {
                    this._reloadCustomers();
                }

                this._notifyAccountLog();
                this._notify(message, true);
            },
            /**
             * Customers page END
             */

            /**
             * Access Report page START
             */
            _computeExportAccessReportApiUrl: function() {
                var url = this._exportAccessReportApi,
                    filters = this.$.appscoAccessReportPage.getAccessReportFilters();

                switch (filters.type) {
                    case 'users':
                        url += '?company_roles=true&contacts=false';
                        break;

                    case 'contacts':
                        url += '?company_roles=false&contacts=true';
                        break;
                }

                if (filters.group.alias && 'all' != filters.group.alias) {
                    url += (-1 < url.indexOf(this._exportAccessReportApi + '?')) ? ('&group=' + filters.group.self) : ('?group=' + filters.group.self);
                }

                if (3 <= filters.term.length) {
                    url += (-1 < url.indexOf(this._exportAccessReportApi + '?')) ? ('&term=' + filters.term) : ('?term=' + filters.term);
                }

                return url;
            },

            _exportAccessReport: function(url) {
                var request = document.createElement('iron-request'),
                    options = {
                        url: url,
                        method: 'GET',
                        handleAs: 'blob',
                        headers: {
                            'Authorization': 'token ' + this.authorizationToken
                        }
                    };

                request.send(options).then(function() {
                    var fileReader = new FileReader();

                    fileReader.onload = function(event) {
                        var link = document.createElement('a');

                        link.href = event.target.result;
                        link.setAttribute('download', 'Access Report.xlsx');
                        document.body.appendChild(link);

                        if (link.click) {
                            link.click();
                        }
                        else if (document.createEvent) {
                            var clickEvent = document.createEvent('MouseEvents');

                            clickEvent.initEvent('click', true, true);
                            link.dispatchEvent(clickEvent);
                        }

                        document.body.removeChild(link);
                    };

                    fileReader.readAsDataURL(request.response);

                    this.fire('export-access-report-finished');
                }.bind(this), function() {
                    this.fire('export-access-report-failed');
                }.bind(this));
            },

            _onExportAccessReportAction: function() {
                this._showProgressBar();
                this._exportAccessReport(('access-report' === this.page) ? this._computeExportAccessReportApiUrl() : this._exportAccessReportApi);
            },

            _onExportAccessReportFinished: function() {
                this._hideProgressBar();
            },

            _onExportAccessReportFailed: function() {
                this._hideProgressBar();
                this._notify('Export of Access Report failed. Please contact AppsCo support.');
            },
            /**
             * Access Report page END
             */

            /**
             * Global START
             */
            _setProgressBar: function(page) {

                switch (page) {
                    case 'home':
                        this.$.appscoHomePage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'resource':
                        this.$.appscoApplicationPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'account':
                        this.$.appscoAccountPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'vault':
                        this.$.appscoVaultPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'resources':
                        this.$.appscoResourcesPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'company-home':
                        this.$.appscoCompanyHomePage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'contact-home':
                        this.$.appscoContactHomePage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'manage-resource':
                        this.$.appscoManageApplicationPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'directory':
                        this.$.appscoDirectoryPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'manage-account':
                        this.$.appscoManageAccountPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'contacts':
                        this.$.appscoContactsPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'groups':
                        this.$.appscoGroupsPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'manage-contact':
                        this.$.appscoManageContactPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'manage-customer':
                        this.$.appscoManageCustomerPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'manage-group':
                        this.$.appscoManageGroupPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'audit-log':
                        this.$.appscoAuditLogPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'provisioning':
                        this.$.appscoProvisioningPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'provisioning-settings':
                        this.$.appscoProvisioningSettingsPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'provisioning-integration-authorization-success':
                        this.$.appscoProvisioningIntegrationSuccessPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'provisioning-integration-authorization-failed':
                        this.$.appscoProvisioningIntegrationFailedPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'company':
                        this.$.appscoCompanyPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'company-account':
                        this.$.appscoCompanyAccountPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'customers':
                        this.$.appscoCustomersPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'reports':
                        this.$.appscoReportsPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    case 'access-report':
                        this.$.appscoAccessReportPage.pageLoaded ? this._hideProgressBar() : this._showProgressBar();
                        break;

                    default:
                        this._hideProgressBar();
                }

            },

            _onPageLoaded: function() {
                this._hideProgressBar();
            },

            _showProgressBar: function() {
                this.$.pageProgress.hidden = false;
            },

            _hideProgressBar: function() {

                setTimeout(function() {
                    this.$.pageProgress.hidden = true;
                }.bind(this), 1000);

            },

            _computeCompany: function(page) {
                return (
                        page === 'company-home' ||
                        page === 'resources' ||
                        page === 'manage-resource' ||
                        page === 'directory' ||
                        page === 'contacts' ||
                        page === 'customers' ||
                        page === 'groups' ||
                        page === 'manage-account' ||
                        page === 'manage-contact' ||
                        page === 'manage-customer' ||
                        page === 'manage-group' ||
                        page === 'statistics' ||
                        page === 'reports' ||
                        page === 'access-report' ||
                        page === 'provisioning' ||
                        page === 'provisioning-settings' ||
                        page === 'provisioning-integration-authorization-success' ||
                        page === 'provisioning-integration-authorization-failed' ||
                        page === 'billing' ||
                        page === 'company' ||
                        page === 'audit-log' ||
                        page === 'company-account' ||
                        page === 'contact-home');
            },

            _computeContactPage: function(page) {
                return page === 'contact-home';
            },

            _computePanel: function(company) {
                return company ? 'appsco-business-product' : 'appsco-product';
            },

            _computeBrandLogo: function(company, companyPage) {
                if (companyPage && company.company && company.company.image) {
                    return company.company.image;
                }

                return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAgCAYAAAB+ZAqzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAVZJREFUeNrsmOENgjAQhcE4AG5QN2AERnCEjsAIdQJG6AiO0BEcATdwhLONxJR6V1u8Ij98ycXkrL3HR+8gVlWCAEDa0EjuaqP1csLGkPJ7FtlNR3hKIzknNeV0uC5YqzhNSc/AiORgKiyCnCbWSm5ar02DHEzFhyB3J9aCf/tL02qckSCvbHSAy60Va9BSSGFn1gAt1zjNlmj5Mr+gdYE0aXZahFmFdOgnSW5aEikivHmWo1NJWnoBLf8ItFujNWumErSwDs3V+xjJoNURtBTwSC6lZQrRmtXhoNXa6IFPIwctE3lYf3crv6TVER26Ki29RVpiNVoJkz+FlmGnlTD5Y7ROia82q9Iat0ALG5xyml3laUXMqkSKZWgRpiha4k+LMPYzWvuYsbquDxhFxn8fzmTt3DNnP9xVNgymbvbCj9SXu8zNeiZTUVocZ27pe/3HA/8QYABzJAP50CmRFwAAAABJRU5ErkJggg==";
            },

            _computeBrandTitle: function(company, companyPage) {
                if (!companyPage) {
                    return 'AppsCo';
                }

                return '';
            },

            _setAccountCompany: function(company) {
                var newCompany = JSON.parse(JSON.stringify(this.currentCompany)),
                    companies = JSON.parse(JSON.stringify(this.account.companies)),
                    length = companies.length;

                newCompany.company = company;

                this.set('currentCompany', {
                    company: {}
                });

                this.set('currentCompany', newCompany);

                for (var i = 0; i < length; i++) {
                    if (company.alias === companies[i].company.alias) {
                        companies[i].company = company;
                        break;
                    }
                }
                companies.sort(this._compareCompaniesByName);

                this.set('account.companies', []);
                this.set('account.companies', companies);
            },

            _compareCompaniesByName: function(companyA, companyB) {
                companyA = companyA.company.name.toLowerCase();
                companyB = companyB.company.name.toLowerCase();

                return companyA < companyB ? -1 : companyA > companyB ? 1 : 0;
            },

            _onPageAnimationFinish: function(event) {
                var fromPage = event.detail.fromPage,
                    toPage = event.detail.toPage;

                switch (fromPage.getAttribute('name')) {

                    case 'home':
                        if (fromPage.$) {
                            this._applicationsApi = this.api.icons;
                            fromPage.resetPage();
                        }

                        break;

                    case 'resource':
                    case 'account':
                    case 'company-home':
                    case 'resources':
                    case 'manage-resource':
                    case 'directory':
                    case 'contacts':
                    case 'manage-account':
                    case 'manage-contact':
                    case 'manage-customer':
                    case 'manage-group':
                    case 'audit-log':
                    case 'provisioning-settings':
                    case 'company':
                    case 'company-account':
                    case 'contact-home':
                    case 'groups':
                    case 'customers':
                    case 'reports':
                    case 'access-report':

                        if (fromPage.$) {
                            fromPage.resetPage();
                        }

                        break;

                    default:
                        break;
                }

                switch (toPage.getAttribute('name')) {
                    case 'home':
                    case 'company-home':
                    case 'resources':
                    case 'provisioning-settings':
                    case 'contacts':
                    case 'customers':
                    case 'reports':

                        if (toPage.$) {
                            toPage.initializePage();
                        }

                        break;

                    case 'directory':

                        if (toPage.$) {
                            toPage.setDefaultAccount();
                        }

                        break;

                    case 'audit-log':

                        if (toPage.$) {
                            toPage.reloadLog();
                        }

                        break;

                    case 'statistics':

                        if (toPage.$) {
                            toPage.reloadStatistics();
                        }

                        break;

                    case 'groups':

                        if (toPage.$) {
                            toPage.setDefaultGroup();
                        }

                        break;

                    default:
                        break;
                }

            },

            _onPageActionsAnimationFinish: function(event) {
                var fromPage = event.detail.fromPage;

                switch (fromPage.getAttribute('name')) {

                    case 'home':
                    case 'resources':
                    case 'directory':
                    case 'contacts':
                    case 'customers':

                        if (fromPage.$) {
                            fromPage.resetPage();
                        }

                        break;

                    default:
                        break;
                }
            },

            _notifyAccountLog: function() {
                this.fire('reload-account-log');
            },

            _notifyReloadApplications: function() {
                this.fire('reload-applications');
            },

            _notifyReloadAccounts: function() {
                this.fire('reload-accounts');
            },

            _notify: function(message, persistant) {
                var toast = this.$.toast;

                this._toastPersistence = persistant;
                toast.duration = persistant ? 0 : 3000;

                if (toast.opened) {
                    toast.cancel();
                    this._toastMessage = message;
                }
                else {
                    this._toastMessage = message;
                    toast.open();
                }
            },

            _closeToastMessage: function() {
                var toast = this.$.toast;

                if (toast.opened) {
                    toast.close();
                    this._toastMessage = '';
                }
            },

            _onCloseToastAction: function() {
                this._closeToastMessage();
            },

            _onToastMessageClosed: function(event) {
                if (event.detail.canceled) {
                    this.$.toast.open();
                }
            },

            _onError: function(event) {
                this._showPage404();
            },

            _getCookie: function(cookieName) {
                var name = cookieName + '=',
                    decodedCookie = decodeURIComponent(document.cookie),
                    cookies = decodedCookie.split(';');

                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i];

                    while (cookie.charAt(0) == ' ') {
                        cookie = cookie.substring(1);
                    }

                    if (cookie.indexOf(name) == 0) {
                        return cookie.substring(name.length, cookie.length);
                    }
                }

                return '';
            },

            _changeTheme: function(companyPage, currentCompany) {
                var company = currentCompany.company ? currentCompany.company : {};

                if (companyPage) {

                    if (company.primary_color) {

                        this.customStyle['--header-background-color'] = company.primary_color;

                        if ('#fff' != company.primary_color && '#ffffff' != company.primary_color) {
                            this.customStyle['--brand-color'] = company.primary_color;
                        }
                        else {
                            this.customStyle['--brand-color'] = 'var(--app-primary-color)';
                        }
                    }
                    else {
                        this.customStyle['--header-background-color'] = 'var(--app-primary-color)';
                        this.customStyle['--brand-color'] = 'var(--app-primary-color)';
                    }

                    if (company.secondary_color) {
                        this.customStyle['--brand-text-color'] = company.secondary_color;
                        this.customStyle['--header-text-color'] = company.secondary_color;
                    }
                    else {
                        this.customStyle['--brand-text-color'] = 'var(--brand-default-text-color)';
                        this.customStyle['--header-text-color'] = 'var(--brand-default-text-color)';
                    }
                }
                else {
                    this.customStyle['--header-background-color'] = 'var(--app-primary-color)';
                    this.customStyle['--header-text-color'] = 'var(--brand-default-text-color)';
                    this.customStyle['--brand-color'] = 'var(--app-primary-color)';
                    this.customStyle['--brand-text-color'] = 'var(--brand-default-text-color)';
                }

                this.updateStyles();
            },

            _onCopiedApplicationAttribute: function(event) {
                var appRequest = document.createElement('iron-request'),
                        application = event.detail.application.application;

                if (!!application.company) {
                    appRequest.send({
                        url: application.self + '/track-events',
                        method: 'POST',
                        handleAs: 'json',
                        body: 'track_events[event_type] = copy_event&track_events[field]=' + encodeURIComponent(event.detail.attribute),
                        headers: {
                            'Authorization': 'token ' + this.authorizationToken,
                            'Content-Type': 'application/x-www-form-urlencoded'
                        }
                    });
                }
            },

            _reloadApplicationsForCompanyAdministrator: function() {

                if (this.currentCompany.company_admin) {
                    this._reloadHomePageApplications();
                    this._reloadCompanyHomePageApplications();
                    this._reloadContactHomePageApplications();
                }
            },

            _onBackToHomePageAction: function() {
                this._showHomePage();
                this._setProduct(false);
            },

            _setNativeCompanyAsCurrent: function() {
                var nativeCompany = this.account.native_company,
                    accountCompanies = this.account.companies,
                    length = accountCompanies.length;

                for (var i = 0; i < length; i++) {
                    var company = accountCompanies[i];

                    if (nativeCompany.alias === company.company.alias) {
                        this.set('currentCompany', company);
                        break;
                    }
                }
            },

            _setupCompanyAccountPage: function(page, account) {

                if ('company-account' === page && account.self) {
                    account.native_company ? this._setNativeCompanyAsCurrent() : this._showHomePage();
                }
            },

            _onBackFromAccountAction: function() {
                this._accountManaged ? this._showCompanyHomePage() : this._showHomePage();
            },

            _onResetPageActions: function() {
                var currentActions = this.getCurrentAppscoPageActionsElement();

                if (currentActions) {
                    currentActions.resetPageActions();
                }
            }
            /**
             * Global END
             */
        });
    </script>
</dom-module>
